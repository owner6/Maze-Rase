<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ó–æ–º–±—ñ-–ê–ø–æ–∫–∞–ª—ñ–ø—Å–∏—Å: –õ–∞–±—ñ—Ä–∏–Ω—Ç –í–∏–∂–∏–≤–∞–Ω–Ω—è</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 50vh;
      padding: 10px;
    }

    .header {
      text-align: center;
      margin-bottom: 0px;
    }

    .header h1 {
      font-size: 1em;
      margin-bottom: 5px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      color: #e74c3c;
    }

    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 5px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 12px 24px;
      background: linear-gradient(45deg, #e74c3c, #c0392b);
      border: none;
      border-radius: 25px;
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    }

    .btn:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
    }

    .game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      padding: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      max-width: 1200px;
      width: 100%;
    }

    .player-info {
      margin-bottom: 15px;
      text-align: center;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .player-name {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 5px;
      color: #3498db;
    }

    .player-status {
      font-size: 1.1em;
      padding: 5px 15px;
      border-radius: 15px;
      display: inline-block;
    }

    .status-ready { background: rgba(52, 152, 219, 0.8); }
    .status-playing { background: rgba(46, 204, 113, 0.8); }
    .status-finished { background: rgba(231, 76, 60, 0.8); }
    .status-winner { background: rgba(241, 196, 15, 0.8); }

    .maze-container {
      border: 3px solid rgba(255,255,255,0.2);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      margin-bottom: 20px;
    }

    .maze {
      display: grid;
      background: #2c3e50;
    }

    .cell {
      width: 15px;
      height: 15px;
      border: 0.5px solid rgba(52, 73, 94, 0.5);
    }

    .wall { background: #34495e; }
    .path { background: #ecf0f1; }
    .start { background: #27ae60; }
    .end { background: #e74c3c; }
    .player { background: #3498db; box-shadow: 0 0 10px #3498db; }
    .zombie { 
      background: #8B4513; 
      box-shadow: 0 0 8px #8B4513;
      border-radius: 50%;
    }
    .zombie-fast { 
      background: #FF4500; 
      box-shadow: 0 0 8px #FF4500;
      border-radius: 50%;
    }
    .zombie-boss { 
      background: #1a0033;
      border-radius: 10px;
      border: 3px solid #ff2222;
      box-shadow: 0 0 16px 4px #ff2222, 0 0 8px 2px #fff;
      position: relative;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .ammo-cell {
      background: #FFD700;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #FFA500;
      z-index: 2;
    }
    .health-cell {
      background: #FF69B4;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #FF1493;
      z-index: 2;
    }
    .shield-cell {
      background: #00CED1;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #008B8B;
      z-index: 2;
    }
    .safe-zone {
      background: #32CD32;
      border: 2px solid #228B22;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    .timer {
      font-size: 1.1em;
      margin: 0;
      padding: 5px 15px;
      background: rgba(0,0,0,0.5);
      border-radius: 15px;
      display: inline-block;
    }

    .stats-bar {
      display: flex;
      gap: 20px;
      margin: 5px 5;
      flex-wrap: wrap;
      justify-content: center;
    }

    .stat-item {
      background: rgba(0,0,0,0.3);
      padding: 8px 15px;
      border-radius: 10px;
      font-size: 14px;
    }

    .instructions {
      margin-top: 20px;
      text-align: center;
      max-width: 600px;
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }

    .winner-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .winner-modal {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.7);
      animation: modalAppear 0.5s ease-out;
    }

    @keyframes modalAppear {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .winner-text {
      font-size: 3em;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }

    .size-controls {
      display: flex;
      gap: 10px;
      align-items: center;
      margin: 10px 0;
    }

    .size-controls label {
      font-weight: bold;
    }

    .size-controls select {
      padding: 8px;
      border-radius: 8px;
      border: none;
      background: rgba(255,255,255,0.2);
      color: white;
      font-size: 14px;
    }

    .event-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(45deg, #e74c3c, #c0392b);
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      font-weight: bold;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      z-index: 1000;
      animation: slideInRight 0.5s ease-out;
      max-width: 300px;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    @media (max-width: 768px) {
      .cell {
        width: 13px;
        height: 13px;
      }

      .header h1 {
        font-size: 2em;
      }
    }

    .pickaxe-cell {
      background: gold;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #bfa100;
      z-index: 2;
    }

    .knife-cell {
      background: #8B0000;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #660000;
      z-index: 2;
    }

    .stake-cell {
      background: #FFD700;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #FFA500;
      z-index: 2;
    }

    .mine-cell {
      background: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #444;
      border-radius: 50%;
      position: relative;
      z-index: 2;
    }
    .mine-cell::after {
      content: '';
      width: 6px;
      height: 6px;
      background: #ff2222;
      border-radius: 50%;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }
    .mine-cell.mine-item {
      background: #ffe066 !important;
      border: 2px solid #ffd700 !important;
    }
  </style>
</head>
<body>
<!-- –î–æ–¥–∞—é –∞—É–¥—ñ–æ-–µ–ª–µ–º–µ–Ω—Ç–∏ -->
<audio id="audioStart" src="sounds/start.wav"></audio>
<audio id="audioKnife" src="sounds/knife.wav"></audio>
<audio id="audioGun" src="sounds/gun.wav"></audio>
<audio id="audioStep" src="sounds/step.wav"></audio>
<audio id="audioZombie" src="sounds/zombie.wav"></audio>
<audio id="audioPickup" src="sounds/pickup.wav"></audio>
<audio id="audioWin" src="sounds/win.wav"></audio>
<audio id="audioLose" src="sounds/lose.wav"></audio>
<audio id="audioMineExplosion" src="sounds/mine-explosion.flac"></audio>
<audio id="audioMinePlace" src="sounds/mine-place.flac"></audio>
<audio id="audioZombieHit" src="sounds/zombie-hit.wav"></audio>
<audio id="audioZombieKill" src="sounds/zombie-kill.wav"></audio>
<audio id="audioZombieSee" src="sounds/zombie-see.ogg"></audio>
<audio id="audioSafeZone" src="sounds/safe-zone.wav"></audio>
<audio id="audioZombieBite" src="sounds/zombie-bite.wav"></audio>
<audio id="audioBreakWall" src="sounds/break-wall.wav"></audio>
<audio id="audioPlayerDeath" src="sounds/player-death.mp3"></audio>

<div class="header">
  <h1>üßü‚Äç‚ôÇÔ∏è –ó–æ–º–±—ñ-–ê–ø–æ–∫–∞–ª—ñ–ø—Å–∏—Å: –õ–∞–±—ñ—Ä–∏–Ω—Ç –í–∏–∂–∏–≤–∞–Ω–Ω—è</h1>
</div>

<div class="controls">
  <div class="size-controls">
    <label>–†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:</label>
    <select id="difficultyLevel">
      <option value="easy" selected>–õ–µ–≥–∫–∏–π</option>
      <option value="medium">–°–µ—Ä–µ–¥–Ω—ñ–π</option>
      <option value="hard">–í–∞–∂–∫–∏–π</option>
      <option value="nightmare">–ö–æ—à–º–∞—Ä</option>
    </select>
  </div>
  <button class="btn" id="newGameBtn">üßü‚Äç‚ôÇÔ∏è –ù–æ–≤–∞ –≥—Ä–∞</button>
  <button class="btn" id="pauseBtn" disabled>‚è∏Ô∏è –ü–∞—É–∑–∞</button>
  <button class="btn" id="helpBtn">‚ùì –î–æ–ø–æ–º–æ–≥–∞</button>
</div>

<div class="game-container">
  <div class="player-info">
    <div>
      <div class="player-name">üéØ –ì–†–ê–í–ï–¶–¨</div>
      <div class="player-status status-ready" id="playerStatus">–ì–æ—Ç–æ–≤ –¥–æ –≤–∏–∂–∏–≤–∞–Ω–Ω—è</div>
    </div>
    <div class="timer" id="timer">–ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è: 00:00</div>
  </div>
  
  <div class="stats-bar" id="statsBar">
    <div class="stat-item">‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤'—è: <span id="healthDisplay">100</span></div>
    <div class="stat-item">üõ°Ô∏è –©–∏—Ç: <span id="shieldDisplay">0</span></div>
    <div class="stat-item">üî´ –ü–∞—Ç—Ä–æ–Ω–∏: <span id="ammoDisplay">10</span></div>
    <div class="stat-item">üßü‚Äç‚ôÇÔ∏è –ó–æ–º–±—ñ: <span id="zombieCount">0</span></div>
    <div class="stat-item">üèÜ –†—ñ–≤–µ–Ω—å: <span id="levelDisplay">1</span></div>
  </div>

  <div class="maze-container">
    <div class="maze" id="maze"></div>
  </div>
</div>

<div class="winner-overlay" id="winnerOverlay">
  <div class="winner-modal">
    <div class="winner-text" id="winnerText">üèÜ –í–ò–ñ–ò–í!</div>
    <p id="winnerMessage">–í—ñ—Ç–∞—î–º–æ –∑ –≤–∏–∂–∏–≤–∞–Ω–Ω—è–º!</p>
    <button class="btn" id="playAgainBtn">üîÑ –ì—Ä–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
  </div>
</div>

<script>
class MazeGenerator {
  constructor(size) {
    this.size = size;
    this.maze = [];
    this.generate();
  }

  generate() {
    this.maze = Array(this.size).fill().map(() => Array(this.size).fill(1));
    const stack = [];
    const start = [1, 1];
    this.maze[start[0]][start[1]] = 0;
    stack.push(start);

    while (stack.length > 0) {
      const current = stack[stack.length - 1];
      const neighbors = this.getUnvisitedNeighbors(current);

      if (neighbors.length > 0) {
        const next = neighbors[Math.floor(Math.random() * neighbors.length)];
        this.removeWall(current, next);
        this.maze[next[0]][next[1]] = 0;
        stack.push(next);
      } else {
        stack.pop();
      }
    }

    this.maze[this.size - 2][this.size - 2] = 0;
  }

  getUnvisitedNeighbors([row, col]) {
    const neighbors = [];
    const directions = [[0, 2], [2, 0], [0, -2], [-2, 0]];

    for (const [dr, dc] of directions) {
      const newRow = row + dr;
      const newCol = col + dc;

      if (newRow > 0 && newRow < this.size - 1 &&
        newCol > 0 && newCol < this.size - 1 &&
        this.maze[newRow][newCol] === 1) {
        neighbors.push([newRow, newCol]);
      }
    }

    return neighbors;
  }

  removeWall([row1, col1], [row2, col2]) {
    const wallRow = (row1 + row2) / 2;
    const wallCol = (col1 + col2) / 2;
    this.maze[wallRow][wallCol] = 0;
  }
}

class ZombieApocalypseGame {
  constructor() {
    this.size = 45;
    this.maze = null;
    this.playerPos = [1, 1];
    this.isGameActive = false;
    this.isPaused = false;
    this.startTime = null;
    this.timerInterval = null;
    this.playerDirection = null;
    this.playerMoveInterval = null;
    this.zombies = [];
    this.zombieMoveInterval = null;
    this.eventInterval = null;
    this.itemSpawnInterval = null;
    this.zombieTypeChangeInterval = null;
    this.collisionCheckInterval = null;
    this.playerBlockedUntil = 0;
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä–∞–≤—Ü—è
    this.playerHealth = 100;
    this.playerShield = 0;
    this.playerAmmo = 10;
    this.playerLevel = 1;
    this.zombiesKilled = 0;
    this.survivalTime = 0;
    
    // –ü—Ä–µ–¥–º–µ—Ç–∏
    this.ammoPos = null;
    this.ammoVisible = false;
    this.healthPos = null;
    this.healthVisible = false;
    this.shieldPos = null;
    this.shieldVisible = false;
    this.pickaxePos = null;
    this.pickaxeVisible = false;
    this.playerHasPickaxe = false;
    this.knifePos = null;
    this.knifeVisible = false;
    this.playerHasKnife = false;
    this.minePos = null;
    this.mineVisible = false;
    this.playerMines = 0;
    this.mineTimeout = null;
    this.activeMines = [];
    
    // –¢–∞–π–º–µ—Ä–∏ –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç—ñ–≤
    this.ammoTimeout = null;
    this.healthTimeout = null;
    this.shieldTimeout = null;
    this.pickaxeTimeout = null;
    this.knifeTimeout = null;
    
    // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Å–ø–∞–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
    this.lastDamageTime = 0;
    this.damageCooldown = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞ –º—ñ–∂ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –ø—Ä–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è
    
    // –ë–µ–∑–ø–µ—á–Ω—ñ –∑–æ–Ω–∏
    this.safeZones = [];
    this.safeZoneTimeout = null;
    
    // –í–∏—Ö—ñ–¥ (–∑'—è–≤–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è –≤–±–∏–≤—Å—Ç–≤–∞ –≤—Å—ñ—Ö –∑–æ–º–±—ñ)
    this.exitPos = null;
    this.exitVisible = false;
    
    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
    this.difficulty = 'easy';
    this.zombieSpawnRate = 5000;
    this.itemSpawnRate = 8000;
    this.safeZoneRate = 15000;
    
    // –°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏—Ö –∫–ª–∞–≤—ñ—à —Ä—É—Ö—É
    this.pressedKeys = new Set();
    
    this.initializeElements();
    this.setupEventListeners();
    
    // –î–æ–¥–∞—é –∞—É–¥—ñ–æ-–µ–ª–µ–º–µ–Ω—Ç–∏
    this.audioStart = document.getElementById('audioStart');
    this.audioKnife = document.getElementById('audioKnife');
    this.audioGun = document.getElementById('audioGun');
    this.audioStep = document.getElementById('audioStep');
    this.audioZombie = document.getElementById('audioZombie');
    this.audioPickup = document.getElementById('audioPickup');
    this.audioWin = document.getElementById('audioWin');
    this.audioLose = document.getElementById('audioLose');
    this.audioMineExplosion = document.getElementById('audioMineExplosion');
    this.audioMinePlace = document.getElementById('audioMinePlace');
    this.audioZombieHit = document.getElementById('audioZombieHit');
    this.audioZombieKill = document.getElementById('audioZombieKill');
    this.audioZombieSee = document.getElementById('audioZombieSee');
    this.audioSafeZone = document.getElementById('audioSafeZone');
    this.audioZombieBite = document.getElementById('audioZombieBite');
    this.audioBreakWall = document.getElementById('audioBreakWall');
    this.audioPlayerDeath = document.getElementById('audioPlayerDeath');
    this.wasInSafeZone = false;
    
    this.zombieLastSeenState = new Map(); // –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –∑–≤—É–∫—É –ø–æ—è–≤–∏ —É –ø–æ–ª—ñ –∑–æ—Ä—É
  }

  initializeElements() {
    this.mazeEl = document.getElementById('maze');
    this.playerStatusEl = document.getElementById('playerStatus');
    this.timerEl = document.getElementById('timer');
    this.winnerOverlay = document.getElementById('winnerOverlay');
    this.winnerText = document.getElementById('winnerText');
    this.winnerMessage = document.getElementById('winnerMessage');
    this.newGameBtn = document.getElementById('newGameBtn');
    this.pauseBtn = document.getElementById('pauseBtn');
    this.playAgainBtn = document.getElementById('playAgainBtn');
    this.difficultySelect = document.getElementById('difficultyLevel');
  }

  setupEventListeners() {
    this.newGameBtn.addEventListener('click', () => this.newGame());
    this.pauseBtn.addEventListener('click', () => this.togglePause());
    this.playAgainBtn.addEventListener('click', () => this.newGame());

    document.getElementById('helpBtn').addEventListener('click', () => {
      alert('üßü‚Äç‚ôÇÔ∏è –ó–û–ú–ë–Ü-–ê–ü–û–ö–ê–õ–Ü–ü–°–ò–°: –õ–ê–ë–Ü–†–ò–ù–¢ –í–ò–ñ–ò–í–ê–ù–ù–Ø\n\nüéØ –¶—ñ–ª—å: –ó–Ω–∏—â–∏—Ç–∏ –≤—Å—ñ—Ö –∑–æ–º–±—ñ, —â–æ–± –∑\'—è–≤–∏–≤—Å—è —á–µ—Ä–≤–æ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç (–≤–∏—Ö—ñ–¥), –ø–æ—Ç—ñ–º –¥—ñ—Å—Ç–∞—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ!\n\nüéÆ –ö–µ—Ä—É–≤–∞–Ω–Ω—è:\n‚Ä¢ –°—Ç—Ä—ñ–ª–∫–∏ ‚Üê‚Üë‚Üì‚Üí –∞–±–æ WASD –¥–ª—è —Ä—É—Ö—É\n‚Ä¢ –ü—Ä–æ–±—ñ–ª –¥–ª—è –∞—Ç–∞–∫–∏ (—Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ —Å—Ç–æ—ó—Ç–µ)\n‚Ä¢ E –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–ø–æ—Ä–∞ (—è–∫—â–æ —î)\n\n‚öîÔ∏è –ë–æ–π–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞:\n‚Ä¢ –ë–ª–∏–∂–Ω—ñ–π –±—ñ–π (–∑–æ–º–±—ñ –Ω–∞ –≤–∞—à—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ): –ü–æ—Ç—Ä—ñ–±–µ–Ω –Ω—ñ–∂, –ø–∞—Ç—Ä–æ–Ω–∏ –Ω–µ –≤–∏—Ç—Ä–∞—á–∞—é—Ç—å—Å—è.\n‚Ä¢ –°—Ç—Ä—ñ–ª—å–±–∞ (–∑–æ–º–±—ñ –Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—ñ): –ü–æ—Ç—Ä—ñ–±–Ω—ñ –ø–∞—Ç—Ä–æ–Ω–∏, –Ω—ñ–∂ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω.\n‚Ä¢ –ë–µ–∑ –Ω–æ–∂–∞ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –≤ –±–ª–∏–∂–Ω—å–æ–º—É –±–æ—é!\n‚Ä¢ –ë–µ–∑ –ø–∞—Ç—Ä–æ–Ω—ñ–≤ –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å—Ç—Ä—ñ–ª—è—Ç–∏!\n\nüìã –Ü–Ω—à–µ:\n‚Ä¢ –ó–µ–ª–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç - —Å—Ç–∞—Ä—Ç\n‚Ä¢ –ó–æ–º–±—ñ —Ä—É—Ö–∞—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é A* –∞–ª–≥–æ—Ä–∏—Ç–º—É\n‚Ä¢ –ó–±–∏—Ä–∞–π—Ç–µ –ø–∞—Ç—Ä–æ–Ω–∏, –∑–¥–æ—Ä–æ–≤\'—è, —â–∏—Ç–∏ —Ç–∞ —Ç–æ–ø–æ—Ä–∏\n‚Ä¢ –¢–æ–ø–æ—Ä –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–æ—Ä—É–±—É–≤–∞—Ç–∏ —Å—Ç—ñ–Ω–∏ (–∫–Ω–æ–ø–∫–∞ E)\n‚Ä¢ –ë–µ–∑–ø–µ—á–Ω—ñ –∑–æ–Ω–∏ —Ç–∏–º—á–∞—Å–æ–≤–æ –∑–∞—Ö–∏—â–∞—é—Ç—å –≤—ñ–¥ –∑–æ–º–±—ñ\n‚Ä¢ –ó–æ–º–±—ñ –∑\'—è–≤–ª—è—é—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ñ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤\n‚Ä¢ –¢–∏–ø–∏ –∑–æ–º–±—ñ –∑–º—ñ–Ω—é—é—Ç—å—Å—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥\n‚Ä¢ –ó–¥–æ—Ä–æ–≤\'—è –∑–æ–º–±—ñ: –ó–≤–∏—á–∞–π–Ω–∏–π(2), –®–≤–∏–¥–∫–∏–π(3), –ë–æ—Å(5)');
    });

    // –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏—Ö –∫–ª–∞–≤—ñ—à —Ä—É—Ö—É
    document.addEventListener('keydown', (e) => {
      const movementKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'KeyW', 'KeyA', 'KeyS', 'KeyD'];
      if (movementKeys.includes(e.code)) {
        this.pressedKeys.add(e.code);
        // –û–Ω–æ–≤–ª—é—î–º–æ –Ω–∞–ø—Ä—è–º–æ–∫ —Ä—É—Ö—É –Ω–∞ –æ—Å—Ç–∞–Ω–Ω—é –Ω–∞—Ç–∏—Å–Ω—É—Ç—É –∫–ª–∞–≤—ñ—à—É
        const keyMap = {
          'ArrowUp': [-1, 0], 'KeyW': [-1, 0],
          'ArrowDown': [1, 0], 'KeyS': [1, 0],
          'ArrowLeft': [0, -1], 'KeyA': [0, -1],
          'ArrowRight': [0, 1], 'KeyD': [0, 1]
        };
        this.playerDirection = keyMap[e.code];
      }
      // --- –î–æ–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –ø—Ä–æ–±—ñ–ª—É ---
      if (e.code === 'Space') {
        if (!this.spacePressed) {
          this.spacePressed = true;
          this.handleKeyPress(e);
        }
        e.preventDefault();
        return;
      }
      this.handleKeyPress(e);
      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω—ã –ø–æ X
      if (e.code === 'KeyX') {
        this.tryPlaceMine();
      }
    });
    
    document.addEventListener('keyup', (e) => {
      const movementKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'KeyW', 'KeyA', 'KeyS', 'KeyD'];
      if (movementKeys.includes(e.code)) {
        this.pressedKeys.delete(e.code);
        // –Ø–∫—â–æ –∂–æ–¥–Ω–∞ –∫–ª–∞–≤—ñ—à–∞ –Ω–µ –∑–∞—Ç–∏—Å–Ω—É—Ç–∞ ‚Äî –∑—É–ø–∏–Ω—è—î–º–æ —Ä—É—Ö
        if (this.pressedKeys.size === 0) {
          this.playerDirection = null;
        } else {
          // –Ø–∫—â–æ —â–µ —î –∑–∞—Ç–∏—Å–Ω—É—Ç—ñ ‚Äî —Ä—É—Ö–∞—î–º–æ—Å—è —É –Ω–∞–ø—Ä—è–º–∫—É –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –∑ –Ω–∏—Ö
          const lastKey = Array.from(this.pressedKeys).slice(-1)[0];
          const keyMap = {
            'ArrowUp': [-1, 0], 'KeyW': [-1, 0],
            'ArrowDown': [1, 0], 'KeyS': [1, 0],
            'ArrowLeft': [0, -1], 'KeyA': [0, -1],
            'ArrowRight': [0, 1], 'KeyD': [0, 1]
          };
          this.playerDirection = keyMap[lastKey];
        }
      }
      // --- –°–∫–∏–¥–∞—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –ø—Ä–æ–±—ñ–ª—É ---
      if (e.code === 'Space') {
        this.spacePressed = false;
      }
    });
    
    this.difficultySelect.addEventListener('change', (e) => {
      this.difficulty = e.target.value;
      this.updateDifficultySettings();
      this.updateStats();
    });
  }

  updateDifficultySettings() {
    switch(this.difficulty) {
      case 'easy':
        this.zombieSpawnRate = 5000;
        this.itemSpawnRate = 8000;
        this.safeZoneRate = 15000;
        break;
      case 'medium':
        this.zombieSpawnRate = 4000;
        this.itemSpawnRate = 7000;
        this.safeZoneRate = 12000;
        break;
      case 'hard':
        this.zombieSpawnRate = 3000;
        this.itemSpawnRate = 6000;
        this.safeZoneRate = 10000;
        break;
      case 'nightmare':
        this.zombieSpawnRate = 2000;
        this.itemSpawnRate = 5000;
        this.safeZoneRate = 8000;
        break;
    }
  }

  clearAllIntervals() {
    if (this.timerInterval) clearInterval(this.timerInterval);
    if (this.playerMoveInterval) clearInterval(this.playerMoveInterval);
    if (this.zombieMoveInterval) clearInterval(this.zombieMoveInterval);
    if (this.eventInterval) clearInterval(this.eventInterval);
    if (this.itemSpawnInterval) clearInterval(this.itemSpawnInterval);
    if (this.zombieTypeChangeInterval) clearInterval(this.zombieTypeChangeInterval);
    if (this.collisionCheckInterval) clearInterval(this.collisionCheckInterval);
    if (this.ammoTimeout) clearTimeout(this.ammoTimeout);
    if (this.healthTimeout) clearTimeout(this.healthTimeout);
    if (this.shieldTimeout) clearTimeout(this.shieldTimeout);
    if (this.pickaxeTimeout) clearTimeout(this.pickaxeTimeout);
    if (this.knifeTimeout) clearTimeout(this.knifeTimeout);
    if (this.safeZoneTimeout) clearTimeout(this.safeZoneTimeout);
    if (this.safeZoneAmmoInterval) clearInterval(this.safeZoneAmmoInterval);
    if (this.safeZoneShieldInterval) clearInterval(this.safeZoneShieldInterval);
    // –°–∫–∏–¥–∞—î–º–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç—ñ –∫–ª–∞–≤—ñ—à—ñ
    this.pressedKeys.clear();
  }

  newGame() {
    this.clearAllIntervals();
    this.isGameActive = true;
    this.isPaused = false;
    this.startTime = Date.now();
    this.playerPos = [1, 1];
    this.playerDirection = null;
    this.activeMines = [];
    
    // –°–∫–∏–¥–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    this.playerHealth = 100;
    this.playerShield = 0;
    this.playerAmmo = 10;
    this.playerLevel = 1;
    this.zombiesKilled = 0;
    this.survivalTime = 0;
    
    // –°–∫–∏–¥–∞–Ω–Ω—è –ø—Ä–µ–¥–º–µ—Ç—ñ–≤
    this.ammoPos = null;
    this.ammoVisible = false;
    this.healthPos = null;
    this.healthVisible = false;
    this.shieldPos = null;
    this.shieldVisible = false;
    this.pickaxePos = null;
    this.pickaxeVisible = false;
    this.playerHasPickaxe = false;
    this.knifePos = null;
    this.knifeVisible = false;
    this.playerHasKnife = false;
    this.minePos = null;
    this.mineVisible = false;
    this.playerMines = 0;
    this.safeZones = [];
    this.exitPos = null;
    this.exitVisible = false;
    
    // –°–∫–∏–¥–∞–Ω–Ω—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Å–ø–∞–º—É
    this.lastDamageTime = 0;
    
    // –û—á–∏—â–µ–Ω–Ω—è —Ç–∞–π–º–µ—Ä—ñ–≤
    if (this.ammoTimeout) clearTimeout(this.ammoTimeout);
    if (this.healthTimeout) clearTimeout(this.healthTimeout);
    if (this.shieldTimeout) clearTimeout(this.shieldTimeout);
    if (this.pickaxeTimeout) clearTimeout(this.pickaxeTimeout);
    if (this.knifeTimeout) clearTimeout(this.knifeTimeout);
    if (this.safeZoneTimeout) clearTimeout(this.safeZoneTimeout);
    
    // –°–∫–∏–¥–∞—î–º–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç—ñ –∫–ª–∞–≤—ñ—à—ñ
    this.pressedKeys.clear();
    
    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ª–∞–±—ñ—Ä–∏–Ω—Ç—É
    const generator = new MazeGenerator(this.size);
    this.maze = generator.maze.map(row => [...row]);
    
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–æ–º–±—ñ
    this.zombies = [];
    this.spawnInitialZombies();
    
    this.renderMaze();
    this.updateStatus('playing');
    this.updateStats();
    this.startTimer();
    this.startPlayerAutoMove();
    this.startZombieAI();
    this.startCollisionCheck();
    this.startItemSpawning();
    this.startSafeZoneSpawning();
    this.startZombieTypeChange();
    this.startRandomMazeEvents();
    
    this.newGameBtn.textContent = 'üîÑ –ù–æ–≤–∞ –≥—Ä–∞';
    this.pauseBtn.disabled = false;
    this.winnerOverlay.style.display = 'none';
    
    if (this.audioStart) { this.audioStart.currentTime = 0; this.audioStart.play(); }
  }

  spawnInitialZombies() {
    const initialZombieCount = this.difficulty === 'easy' ? 3 : 
                              this.difficulty === 'medium' ? 5 :
                              this.difficulty === 'hard' ? 9 : 12;
    
    for (let i = 0; i < initialZombieCount; i++) {
      this.spawnZombie();
    }
  }

  spawnZombie() {
    const pos = this.getRandomEmptyPosition();
    const zombieType = Math.random() < 0.1 ? 'boss' : 
                      Math.random() < 0.3 ? 'fast' : 'normal';
    
    // –†—ñ–∑–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–¥–æ—Ä–æ–≤'—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∑–æ–º–±—ñ
    let health;
    switch(zombieType) {
      case 'boss':
        health = 5; // –ë–æ—Å –∑–æ–º–±—ñ - –Ω–∞–π–º—ñ—Ü–Ω—ñ—à–∏–π
        break;
      case 'fast':
        health = 3; // –®–≤–∏–¥–∫–∏–π –∑–æ–º–±—ñ - —Å–µ—Ä–µ–¥–Ω—è –º—ñ—Ü–Ω—ñ—Å—Ç—å
        break;
      default:
        health = 2; // –ó–≤–∏—á–∞–π–Ω–∏–π –∑–æ–º–±—ñ - –Ω–∞–π—Å–ª–∞–±—à–∏–π
        break;
    }
    
    this.zombies.push({
      pos: pos,
      type: zombieType,
      health: health,
      maxHealth: health, // –î–æ–¥–∞—î–º–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–¥–æ—Ä–æ–≤'—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
      speed: zombieType === 'fast' ? 80 : zombieType === 'boss' ? 220 : 140,
      state: 'patrolling',
      direction: [0, 1],
      path: [],
      pathIndex: 0,
      lastMoveTime: Date.now(), // –î–æ–¥–∞—î–º–æ lastMoveTime –¥–ª—è —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ–≥–æ —Ä—É—Ö—É
      stunnedUntil: 0 // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º—è –æ–≥–ª—É—à–µ–Ω–∏—è
    });
  }

  getRandomEmptyPosition() {
    let row, col;
    do {
      row = Math.floor(Math.random() * (this.size - 2)) + 1;
      col = Math.floor(Math.random() * (this.size - 2)) + 1;
    } while (
      this.maze[row][col] === 1 ||
      (row === this.playerPos[0] && col === this.playerPos[1]) ||
      this.zombies.some(z => z.pos[0] === row && z.pos[1] === col) ||
      this.safeZones.some(sz => sz[0] === row && sz[1] === col)
    );
    return [row, col];
  }

  renderMaze() {
    this.mazeEl.innerHTML = '';
    this.mazeEl.style.gridTemplateColumns = `repeat(${this.size}, 1fr)`;
    
    for (let row = 0; row < this.size; row++) {
      for (let col = 0; col < this.size; col++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        
        if (this.maze[row][col] === 1) {
          cell.classList.add('wall');
        } else {
          cell.classList.add('path');
        }
        
        // –°—Ç–∞—Ä—Ç
        if (row === 1 && col === 1) {
          cell.classList.add('start');
        }
        
        // –í–∏—Ö—ñ–¥ (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ)
        if (this.exitVisible && this.exitPos && row === this.exitPos[0] && col === this.exitPos[1]) {
          cell.classList.add('end');
        }
        
        // –ì—Ä–∞–≤–µ—Ü—å
        if (row === this.playerPos[0] && col === this.playerPos[1]) {
          cell.classList.add('player');
        }
        
        // –ó–æ–º–±—ñ
        for (const zombie of this.zombies) {
          if (row === zombie.pos[0] && col === zombie.pos[1]) {
            cell.classList.add('zombie');
            if (zombie.type === 'fast') cell.classList.add('zombie-fast');
            if (zombie.type === 'boss') {
              cell.classList.add('zombie-boss');
              cell.innerHTML = '<span style="font-size:15px;">üíÄ</span>';
            }
            
            // –î–æ–¥–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–¥–æ—Ä–æ–≤'—è –∑–æ–º–±—ñ
            if (zombie.health < zombie.maxHealth) {
              const healthPercent = (zombie.health / zombie.maxHealth) * 100;
              let healthColor = '#00ff00'; // –ó–µ–ª–µ–Ω–∏–π
              if (healthPercent < 50) healthColor = '#ffff00'; // –ñ–æ–≤—Ç–∏–π
              if (healthPercent < 25) healthColor = '#ff0000'; // –ß–µ—Ä–≤–æ–Ω–∏–π
              
              cell.style.border = `2px solid ${healthColor}`;
              cell.style.boxShadow = `0 0 8px ${healthColor}`;
            }
          }
        }
        
        // –ü—Ä–µ–¥–º–µ—Ç–∏
        if (this.ammoVisible && this.ammoPos && row === this.ammoPos[0] && col === this.ammoPos[1]) {
          cell.classList.add('ammo-cell');
          cell.innerHTML = '<span style="font-size:12px;">üî´</span>';
        }
        
        if (this.healthVisible && this.healthPos && row === this.healthPos[0] && col === this.healthPos[1]) {
          cell.classList.add('health-cell');
          cell.innerHTML = '<span style="font-size:12px;">‚ù§Ô∏è</span>';
        }
        
        if (this.shieldVisible && this.shieldPos && row === this.shieldPos[0] && col === this.shieldPos[1]) {
          cell.classList.add('shield-cell');
          cell.innerHTML = '<span style="font-size:12px;">üõ°Ô∏è</span>';
        }
        
        // –¢–æ–ø–æ—Ä
        if (this.pickaxeVisible && this.pickaxePos && row === this.pickaxePos[0] && col === this.pickaxePos[1]) {
          cell.classList.add('pickaxe-cell');
          cell.innerHTML = '<span style="font-size:12px;">ü™ì</span>';
        }
        
        // –ù—ñ–∂
        if (this.knifeVisible && this.knifePos && row === this.knifePos[0] && col === this.knifePos[1]) {
          cell.classList.add('knife-cell');
          cell.innerHTML = '<span style="font-size:12px;">üî™</span>';
        }
        
        // –ë–µ–∑–ø–µ—á–Ω—ñ –∑–æ–Ω–∏
        if (this.safeZones.some(sz => sz[0] === row && sz[1] === col)) {
          cell.classList.add('safe-zone');
        }
        
        // –ú—ñ–Ω–∞
        if (this.mineVisible && this.minePos && row === this.minePos[0] && col === this.minePos[1]) {
          cell.classList.add('mine-cell', 'mine-item');
          cell.innerHTML = '<span style="font-size:13px;">üí£</span>';
        }
        // –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∏–Ω—ã
        if (this.activeMines.some(m => m.pos[0] === row && m.pos[1] === col)) {
          cell.classList.add('mine-cell');
          cell.style.border = '2px solid #ff2222';
        }
        
        this.mazeEl.appendChild(cell);
      }
    }
  }

  handleKeyPress(e) {
    if (!this.isGameActive || this.isPaused) return;
    
    const keyMap = {
      'ArrowUp': [-1, 0], 'KeyW': [-1, 0],
      'ArrowDown': [1, 0], 'KeyS': [1, 0],
      'ArrowLeft': [0, -1], 'KeyA': [0, -1],
      'ArrowRight': [0, 1], 'KeyD': [0, 1]
    };
    
    const direction = keyMap[e.code];
    if (direction) {
      e.preventDefault();
      this.playerDirection = direction;
    }
    
    // –°—Ç—Ä—ñ–ª—å–±–∞ (–ø—Ä–æ–±—ñ–ª)
    if (e.code === 'Space') {
      e.preventDefault();
      this.shoot();
    }
    
    // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–ø–æ—Ä–∞ (E)
    if (e.code === 'KeyE' && this.playerHasPickaxe) {
      this.tryBreakWall();
    }
  }

  shoot() {
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∞ –∫–ª–∞–≤—ñ—à–∞ —Ä—É—Ö—É
    const movementKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'KeyW', 'KeyA', 'KeyS', 'KeyD'];
    const isMoving = movementKeys.some(key => this.pressedKeys.has(key));
    
    // –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è —Å—Ç—Ä—ñ–ª—å–±–∏ —É –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ
    const inSafeZone = this.safeZones.some(sz => 
      sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
    );
    if (inSafeZone) {
      this.showEventNotification('‚ùå –£ –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ –Ω–µ –º–æ–∂–Ω–∞ –∞—Ç–∞–∫—É–≤–∞—Ç–∏!');
      return;
    }
    
    if (isMoving) {
      this.showEventNotification('‚ùå –ù–µ –º–æ–∂–Ω–∞ —Å—Ç—Ä—ñ–ª—è—Ç–∏ –ø—ñ–¥ —á–∞—Å —Ä—É—Ö—É! –ó—É–ø–∏–Ω—ñ—Ç—å—Å—è!');
      return;
    }
    
    // –°–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –∑–æ–º–±—ñ –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ –∑ –≥—Ä–∞–≤—Ü–µ–º
    const zombieOnPlayer = this.zombies.findIndex(z => 
      z.pos[0] === this.playerPos[0] && z.pos[1] === this.playerPos[1]
    );
    
    if (zombieOnPlayer !== -1) {
      // –Ø–∫—â–æ –∑–æ–º–±—ñ –Ω–∞ –∫–ª—ñ—Ç–∏–Ω—Ü—ñ –≥—Ä–∞–≤—Ü—è - –±–ª–∏–∂–Ω—ñ–π –±—ñ–π –Ω–æ–∂–µ–º
      if (this.playerHasKnife) {
        this.meleeAttack();
      } else {
        this.showEventNotification('‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω –Ω—ñ–∂ –¥–ª—è –±–ª–∏–∂–Ω—å–æ–≥–æ –±–æ—é!');
      }
    } else {
      // –Ø–∫—â–æ –∑–æ–º–±—ñ –Ω–µ–º–∞—î –Ω–∞ –∫–ª—ñ—Ç–∏–Ω—Ü—ñ –≥—Ä–∞–≤—Ü—è - —Å—Ç—Ä—ñ–ª—è—î–º–æ (—è–∫—â–æ —î –ø–∞—Ç—Ä–æ–Ω–∏)
      if (this.playerAmmo > 0) {
        this.rangedAttack();
      } else {
        this.showEventNotification('‚ùå –ù–µ–º–∞—î –ø–∞—Ç—Ä–æ–Ω—ñ–≤ –¥–ª—è —Å—Ç—Ä—ñ–ª—å–±–∏!');
      }
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –±–ª–∏–∂–Ω—å–æ–≥–æ –±–æ—é –Ω–æ–∂–µ–º (–Ω–µ –≤–∏—Ç—Ä–∞—á–∞—î –ø–∞—Ç—Ä–æ–Ω–∏)
  meleeAttack() {
    // –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –∞—Ç–∞–∫–∏ —É –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ
    const inSafeZone = this.safeZones.some(sz => 
      sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
    );
    if (inSafeZone) {
      this.showEventNotification('‚ùå –£ –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ –Ω–µ –º–æ–∂–Ω–∞ –∞—Ç–∞–∫—É–≤–∞—Ç–∏!');
      return;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –Ω—ñ–∂
    if (!this.playerHasKnife) {
      this.showEventNotification('‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω –Ω—ñ–∂ –¥–ª—è –±–ª–∏–∂–Ω—å–æ–≥–æ –±–æ—é!');
      return;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –∑–æ–º–±—ñ –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ –∑ –≥—Ä–∞–≤—Ü–µ–º
    const zombieOnPlayer = this.zombies.findIndex(z => 
      z.pos[0] === this.playerPos[0] && z.pos[1] === this.playerPos[1]
    );
    
    if (zombieOnPlayer !== -1) {
      // –î–æ–¥–∞—î–º–æ —à–∞–Ω—Å –Ω–∞ –ø—Ä–æ–º–∞—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, 70% —à–∞–Ω—Å –≤–ª—É—á–∏—Ç–∏.
      if (Math.random() < 0.65) {
        // –£—Å–ø—ñ—à–Ω–∏–π —É–¥–∞—Ä
        const zombie = this.zombies[zombieOnPlayer];
        zombie.health--;
        if (this.audioZombieHit) { this.audioZombieHit.currentTime = 0; this.audioZombieHit.play(); }
        if (zombie.health <= 0) {
          this.zombies.splice(zombieOnPlayer, 1);
          this.zombiesKilled++;
          if (this.audioZombieKill) { this.audioZombieKill.currentTime = 0; this.audioZombieKill.play(); }
          this.showEventNotification(`üî™ ${zombie.type.toUpperCase()} –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω–æ –Ω–æ–∂–µ–º!`);
          
          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ
          if (this.zombies.length === 0) {
            this.spawnExit();
            this.showEventNotification('üèÜ –í—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ! –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∏—Ö—ñ–¥!');
          }
        } else {
          this.showEventNotification(`üî™ ${zombie.type.toUpperCase()} –∑–æ–º–±—ñ –ø–æ—Ä–∞–Ω–µ–Ω–æ –Ω–æ–∂–µ–º! (${zombie.health}/${zombie.maxHealth})`);
        }
        this.renderMaze();
        this.updateStats();
      } else {
        // –ü—Ä–æ–º–∞—Ö
        this.showEventNotification('üî™ –ü—Ä–æ–º–∞—Ö!');
      }
    } else {
      this.showEventNotification('‚ùå –ù–µ–º–∞—î –∑–æ–º–±—ñ –¥–ª—è –∞—Ç–∞–∫–∏ –Ω–æ–∂–µ–º!');
    }
    
    if (this.audioKnife) { this.audioKnife.currentTime = 0; this.audioKnife.play(); }
  }

  // –§—É–Ω–∫—Ü—ñ—è —Å—Ç—Ä—ñ–ª—å–±–∏ (–≤–∏—Ç—Ä–∞—á–∞—î –ø–∞—Ç—Ä–æ–Ω–∏)
  rangedAttack() {
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –ø–∞—Ç—Ä–æ–Ω–∏
    if (this.playerAmmo <= 0) {
      this.showEventNotification('‚ùå –ù–µ–º–∞—î –ø–∞—Ç—Ä–æ–Ω—ñ–≤ –¥–ª—è —Å—Ç—Ä—ñ–ª—å–±–∏!');
      return;
    }
    
    // –í–∏—Ç—Ä–∞—á–∞—î–º–æ –ø–∞—Ç—Ä–æ–Ω
    this.playerAmmo--;
    this.updateStats();
    
    // –î–æ–¥–∞—î–º–æ —à–∞–Ω—Å –Ω–∞ –ø—Ä–æ–º–∞—Ö: 50%
    if (Math.random() >= 0.5) {
      this.showEventNotification('üî´ –ü—Ä–æ–º–∞—Ö!');
      return;
    }
    
    // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –Ω–∞–π–±–ª–∏–∂—á–æ–≥–æ –∑–æ–º–±—ñ –≤ –ø—Ä—è–º—ñ–π –≤–∏–¥–∏–º–æ—Å—Ç—ñ
    const target = this.findZombieInLineOfSight();
    
    if (target) {
      const zombie = this.zombies[target.index];
      zombie.health--;
      if (this.audioZombieHit) { this.audioZombieHit.currentTime = 0; this.audioZombieHit.play(); }
      if (zombie.health <= 0) {
        this.zombies.splice(target.index, 1);
        this.zombiesKilled++;
        if (this.audioZombieKill) { this.audioZombieKill.currentTime = 0; this.audioZombieKill.play(); }
        this.showEventNotification(`üî´ ${zombie.type.toUpperCase()} –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω–æ!`);
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ
        if (this.zombies.length === 0) {
          this.spawnExit();
          this.showEventNotification('üèÜ –í—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ! –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∏—Ö—ñ–¥!');
        }
      } else {
        this.showEventNotification(`üî´ ${zombie.type.toUpperCase()} –∑–æ–º–±—ñ –ø–æ—Ä–∞–Ω–µ–Ω–æ! (${zombie.health}/${zombie.maxHealth})`);
      }
      this.renderMaze();
      this.updateStats();
    } else {
      this.showEventNotification('üî´ –ü—Ä–æ–º–∞—Ö!');
    }
    
    if (this.audioGun) { this.audioGun.currentTime = 0; this.audioGun.play(); }
  }

  // –§—É–Ω–∫—Ü—ñ—è –ø–æ—à—É–∫—É –∑–æ–º–±—ñ –≤ –ø—Ä—è–º—ñ–π –≤–∏–¥–∏–º–æ—Å—Ç—ñ –¥–ª—è —Å—Ç—Ä—ñ–ª—å–±–∏
  findZombieInLineOfSight() {
    const directions = [[-1,0],[1,0],[0,-1],[0,1]];
    let closestTarget = null;
    let closestDistance = Infinity;
    
    for (const [dr, dc] of directions) {
      let r = this.playerPos[0] + dr;
      let c = this.playerPos[1] + dc;
      let distance = 1;
      
      while (r >= 0 && r < this.size && c >= 0 && c < this.size && this.maze[r][c] === 0) {
        const zombieIndex = this.zombies.findIndex(z => z.pos[0] === r && z.pos[1] === c);
        if (zombieIndex !== -1) {
          if (distance < closestDistance) {
            closestTarget = { index: zombieIndex, distance: distance };
            closestDistance = distance;
          }
          break; // –ó—É–ø–∏–Ω—è—î–º–æ—Å—è –Ω–∞ –ø–µ—Ä—à–æ–º—É –∑–æ–º–±—ñ –≤ —Ü—å–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É
        }
        r += dr;
        c += dc;
        distance++;
      }
    }
    
    return closestTarget;
  }

  startPlayerAutoMove() {
    if (this.playerMoveInterval) clearInterval(this.playerMoveInterval);
    this.playerMoveInterval = setInterval(() => {
      if (!this.isGameActive || this.isPaused || Date.now() < this.playerBlockedUntil) return;
      // –î–æ–¥–∞—î–º–æ –≤–∏–∫–ª–∏–∫ checkSafeZone –∑–∞–≤–∂–¥–∏
      this.checkSafeZone();
      if (!this.playerDirection) return;
      const newRow = this.playerPos[0] + this.playerDirection[0];
      const newCol = this.playerPos[1] + this.playerDirection[1];
      if (this.isValidMove(newRow, newCol)) {
        this.playerPos = [newRow, newCol];
        if (this.audioStep) { this.audioStep.currentTime = 0; this.audioStep.play(); }
        this.checkItemPickup();
        this.checkSafeZone();
        this.renderMaze();
      }
    }, 100);
  }

  isValidMove(row, col) {
    return row >= 0 && row < this.size && col >= 0 && col < this.size && this.maze[row][col] === 0;
  }

  checkItemPickup() {
    let picked = false;
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É –ø–∞—Ç—Ä–æ–Ω—ñ–≤
    if (this.ammoVisible && this.ammoPos && 
        this.playerPos[0] === this.ammoPos[0] && this.playerPos[1] === this.ammoPos[1]) {
      this.playerAmmo += 5;
      this.hideAmmo();
      this.updateStats();
      picked = true;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É –∑–¥–æ—Ä–æ–≤'—è
    if (this.healthVisible && this.healthPos && 
        this.playerPos[0] === this.healthPos[0] && this.playerPos[1] === this.healthPos[1]) {
      this.playerHealth = Math.min(100, this.playerHealth + 25);
      this.hideHealth();
      this.updateStats();
      picked = true;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É —â–∏—Ç–∞
    if (this.shieldVisible && this.shieldPos && 
        this.playerPos[0] === this.shieldPos[0] && this.playerPos[1] === this.shieldPos[1]) {
      this.playerShield = Math.min(100, this.playerShield + 50);
      this.hideShield();
      this.updateStats();
      picked = true;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É —Ç–æ–ø–æ—Ä–∞
    if (this.pickaxeVisible && this.pickaxePos && 
        this.playerPos[0] === this.pickaxePos[0] && this.playerPos[1] === this.pickaxePos[1]) {
      this.playerHasPickaxe = true;
      this.hidePickaxe();
      this.updateStats();
      picked = true;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É –Ω–æ–∂–∞
    if (this.knifeVisible && this.knifePos && 
        this.playerPos[0] === this.knifePos[0] && this.playerPos[1] === this.knifePos[1]) {
      this.playerHasKnife = true;
      this.hideKnife();
      this.updateStats();
      picked = true;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–±–æ—Ä—É –º—ñ–Ω–∏
    if (this.mineVisible && this.minePos && 
        this.playerPos[0] === this.minePos[0] && this.playerPos[1] === this.minePos[1]) {
      this.playerMines += 1;
      this.hideMine();
      this.updateStats();
      picked = true;
    }
    
    if (picked && this.audioPickup) { this.audioPickup.currentTime = 0; this.audioPickup.play(); }
  }

  checkSafeZone() {
    const inSafeZone = this.safeZones.some(sz => 
      sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
    );
    if (inSafeZone && !this.wasInSafeZone) {
      if (this.audioSafeZone) { this.audioSafeZone.currentTime = 0; this.audioSafeZone.play(); }
    }
    this.wasInSafeZone = inSafeZone;
    
    if (inSafeZone) {
      this.playerStatusEl.textContent = 'üîã –ó–æ–Ω–∞ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤! –°—Ç—ñ–π—Ç–µ –Ω–µ—Ä—É—Ö–æ–º–æ!';
      this.playerStatusEl.style.background = 'rgba(46, 204, 113, 0.8)';
      // –ó–∞–ø—É—Å–∫–∞—î–º–æ –±–æ–Ω—É—Å–∏, —è–∫—â–æ —â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω—ñ
      if (!this.safeZoneAmmoInterval) {
        this.safeZoneAmmoInterval = setInterval(() => {
          if (!this.isGameActive || this.isPaused) return;
          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≥—Ä–∞–≤–µ—Ü—å –¥–æ—Å—ñ —É –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ —ñ —Å—Ç–æ—ó—Ç—å –Ω–µ—Ä—É—Ö–æ–º–æ
          const stillInSafeZone = this.safeZones.some(sz => 
            sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
          );
          const isMoving = !!this.playerDirection;
          if (stillInSafeZone && !isMoving) {
            this.playerAmmo += 1;
            this.updateStats();
            this.showEventNotification('üî´ +1 –ø–∞—Ç—Ä–æ–Ω (–∑–æ–Ω–∞)');
          }
        }, 2000);
      }
      if (!this.safeZoneShieldInterval) {
        this.safeZoneShieldInterval = setInterval(() => {
          if (!this.isGameActive || this.isPaused) return;
          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≥—Ä–∞–≤–µ—Ü—å –¥–æ—Å—ñ —É –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ —ñ —Å—Ç–æ—ó—Ç—å –Ω–µ—Ä—É—Ö–æ–º–æ
          const stillInSafeZone = this.safeZones.some(sz => 
            sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
          );
          const isMoving = !!this.playerDirection;
          if (stillInSafeZone && !isMoving) {
            this.playerShield = Math.min(100, this.playerShield + 10);
            this.updateStats();
            this.showEventNotification('üõ°Ô∏è +10 —â–∏—Ç–∞ (–∑–æ–Ω–∞)');
          }
        }, 3000);
      }
    } else {
      this.playerStatusEl.textContent = 'üßü‚Äç‚ôÇÔ∏è –í–∏–∂–∏–≤–∞—î...';
      this.playerStatusEl.style.background = 'rgba(52, 152, 219, 0.8)';
      // –ó—É–ø–∏–Ω—è—î–º–æ –±–æ–Ω—É—Å–∏, —è–∫—â–æ –≤–∏–π—à–æ–≤ —ñ–∑ –∑–æ–Ω–∏
      if (this.safeZoneAmmoInterval) {
        clearInterval(this.safeZoneAmmoInterval);
        this.safeZoneAmmoInterval = null;
      }
      if (this.safeZoneShieldInterval) {
        clearInterval(this.safeZoneShieldInterval);
        this.safeZoneShieldInterval = null;
      }
    }
  }

  startZombieAI() {
    if (this.zombieMoveInterval) clearInterval(this.zombieMoveInterval);
    
    setTimeout(() => {
      if (!this.isGameActive) return;
      
      this.zombieMoveInterval = setInterval(() => {
        if (!this.isGameActive || this.isPaused) return;
        this.moveZombies();
      }, 50); // –ß–∞—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —á–∞—Å —Ä—É—Ö–∞—Ç–∏ –∫–æ–≥–æ—Å—å —ñ–∑ –∑–æ–º–±—ñ
    }, 2000);
  }

  startCollisionCheck() {
    if (this.collisionCheckInterval) clearInterval(this.collisionCheckInterval);
    
    this.collisionCheckInterval = setInterval(() => {
      if (!this.isGameActive || this.isPaused) return;
      this.checkCollision();
    }, 50); // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–ª—ñ–∑—ñ—é –∫–æ–∂–Ω—ñ 50–º—Å –¥–ª—è –±—ñ–ª—å—à–æ—ó —Ç–æ—á–Ω–æ—Å—Ç—ñ
  }

  moveZombies() {
    const now = Date.now();
    for (const zombie of this.zombies) {
      if (!zombie.lastMoveTime) zombie.lastMoveTime = now;
      if (zombie.stunnedUntil && now < zombie.stunnedUntil) continue;
      if (now - zombie.lastMoveTime >= zombie.speed) {
        this.moveZombiesGeneric([zombie], this.maze, this.playerPos);
        zombie.lastMoveTime = now;
        // –ó–≤—É–∫ –∑–æ–º–±—ñ, —è–∫—â–æ –ø–æ—Ä—É—á –∑ –≥—Ä–∞–≤—Ü–µ–º
        if (Math.abs(zombie.pos[0] - this.playerPos[0]) + Math.abs(zombie.pos[1] - this.playerPos[1]) <= 2) {
          if (this.audioZombie) { this.audioZombie.currentTime = 0; this.audioZombie.play(); }
        }
      }
    }
    // –ü—ñ—Å–ª—è —Ä—É—Ö—É –≤—Å—ñ—Ö –∑–æ–º–±—ñ ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—ó
    this.checkZombieInteractions(this.zombies, this.maze);
    this.renderMaze();
    this.updateStats();
    this.checkMinesExplosion();
    this.checkPlayerMineExplosion();
  }

  moveZombiesGeneric(zombies, maze, targetPos) {
    for (const zombie of zombies) {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å –ø–æ—Ç–æ—á–Ω–æ–≥–æ —à–ª—è—Ö—É –∑–æ–º–±—ñ
      if (zombie.path && zombie.pathIndex < zombie.path.length) {
        const nextPos = zombie.path[zombie.pathIndex];
        // –ó–∞–±–æ—Ä–æ–Ω—è—î–º–æ —Ä—É—Ö –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤—É —Ç–æ—á–∫—É, —è–∫—â–æ —Å—Ç–∞—Ä—Ç —â–µ –∞–∫—Ç–∏–≤–Ω–∏–π
        if (!this.isValidMove(nextPos[0], nextPos[1]) || (this.isStartActive && nextPos[0] === 1 && nextPos[1] === 1)) {
          // –®–ª—è—Ö –±—ñ–ª—å—à–µ –Ω–µ –≤–∞–ª—ñ–¥–Ω–∏–π, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î–º–æ
          zombie.path = [];
          zombie.pathIndex = 0;
        }
      }

      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, –±–∞—á–∏—Ç—å –ª–∏ –∑–æ–º–±—ñ —Ü—ñ–ª—å
      const prevState = this.zombieLastSeenState.get(zombie) || 'patrolling';
      if (this.canSeeTarget(zombie, maze, targetPos)) {
        zombie.state = 'chasing';
        if (prevState !== 'chasing') {
          if (this.audioZombieSee) { this.audioZombieSee.currentTime = 0; this.audioZombieSee.play(); }
        }
      } else {
        zombie.state = 'patrolling';
      }
      this.zombieLastSeenState.set(zombie, zombie.state);

      if (zombie.state === 'chasing') {
        // –†–µ–∂–∏–º –ø–æ–ª—é–≤–∞–Ω–Ω—è: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ A*
        if (!zombie.path || zombie.pathIndex >= zombie.path.length || Math.random() < 0.1) {
          zombie.path = this.findPathAStarWithStartBlock(maze, zombie.pos, targetPos);
          zombie.pathIndex = 1;
        }
        if (zombie.path && zombie.pathIndex < zombie.path.length) {
          // –ù–µ –¥–æ–∑–≤–æ–ª—è—î–º–æ –∑–æ–º–±—ñ –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç, —è–∫—â–æ —Å—Ç–∞—Ä—Ç –∞–∫—Ç–∏–≤–Ω–∏–π
          if (this.isStartActive && zombie.path[zombie.pathIndex][0] === 1 && zombie.path[zombie.pathIndex][1] === 1) {
            // –ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–∞ –º—ñ—Å—Ü—ñ
          } else {
            zombie.pos = zombie.path[zombie.pathIndex];
          }
          zombie.pathIndex++;
        }
      } else {
        // –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è: –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –Ω–∞–∑–∞–¥, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—è–º–æ–∫ –Ω–∞ –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è—Ö
        const possibleDirections = [[0, 1], [0, -1], [1, 0], [-1, 0]];
        const prevDirection = zombie.direction;
        const reverseDirection = prevDirection ? [-prevDirection[0], -prevDirection[1]] : null;
        // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ –Ω–∞–ø—Ä—è–º–∫–∏ (–∫—Ä—ñ–º –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ, —è–∫—â–æ —î —ñ–Ω—à—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏)
        let validDirections = possibleDirections.filter(dir => {
          const checkPos = [zombie.pos[0] + dir[0], zombie.pos[1] + dir[1]];
          // –ù–µ –π—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç, —è–∫—â–æ —Å—Ç–∞—Ä—Ç –∞–∫—Ç–∏–≤–Ω–∏–π
          if (this.isStartActive && checkPos[0] === 1 && checkPos[1] === 1) return false;
          if (reverseDirection && dir[0] === reverseDirection[0] && dir[1] === reverseDirection[1]) return false;
          return this.isValidMove(checkPos[0], checkPos[1]);
        });
        // –Ø–∫—â–æ —Ç—ñ–ª—å–∫–∏ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π —à–ª—è—Ö –º–æ–∂–ª–∏–≤–∏–π (—Ç—É–ø–∏–∫), –¥–æ–∑–≤–æ–ª—è—î–º–æ –π–æ–≥–æ
        if (validDirections.length === 0 && reverseDirection) {
          const backPos = [zombie.pos[0] + reverseDirection[0], zombie.pos[1] + reverseDirection[1]];
          if (this.isValidMove(backPos[0], backPos[1]) && !(this.isStartActive && backPos[0] === 1 && backPos[1] === 1)) {
            validDirections = [reverseDirection];
          }
        }
        // –ù–∞ –ø–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è—Ö (–±—ñ–ª—å—à–µ 1 –≤–∞—Ä—ñ–∞–Ω—Ç–∞) —ñ–Ω–æ–¥—ñ –∑–º—ñ–Ω—é—î–º–æ –Ω–∞–ø—Ä—è–º–æ–∫ –≤–∏–ø–∞–¥–∫–æ–≤–æ
        if (validDirections.length > 1 && Math.random() < 0.3) {
          zombie.direction = validDirections[Math.floor(Math.random() * validDirections.length)];
        } else if (validDirections.length > 0) {
          // –Ø–∫—â–æ –ø–æ—Ç–æ—á–Ω–∏–π –Ω–∞–ø—Ä—è–º–æ–∫ —â–µ –≤–∞–ª—ñ–¥–Ω–∏–π, –ø—Ä–æ–¥–æ–≤–∂—É—î–º–æ, —ñ–Ω–∞–∫—à–µ –±–µ—Ä–µ–º–æ –Ω–æ–≤–∏–π
          const nextPos = [zombie.pos[0] + (zombie.direction ? zombie.direction[0] : 0), zombie.pos[1] + (zombie.direction ? zombie.direction[1] : 0)];
          if (!zombie.direction || !this.isValidMove(nextPos[0], nextPos[1]) || (this.isStartActive && nextPos[0] === 1 && nextPos[1] === 1)) {
            zombie.direction = validDirections[Math.floor(Math.random() * validDirections.length)];
          }
        }
        // –†—É—Ö–∞—î–º–æ—Å—è –≤ –≤–∏–±—Ä–∞–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É
        if (zombie.direction) {
          const nextPos = [zombie.pos[0] + zombie.direction[0], zombie.pos[1] + zombie.direction[1]];
          if (!(this.isStartActive && nextPos[0] === 1 && nextPos[1] === 1)) {
            zombie.pos = nextPos;
          }
        }
      }
    }
    // –í–∏–¥–∞–ª—è—î–º–æ —Ç—É—Ç –≤–∏–∫–ª–∏–∫–∏ checkZombieInteractions, renderMaze, updateStats
  }

  canSeeTarget(zombie, maze, targetPos) {
    // –°—Ç–∞—Ä—Ç–æ–≤–∞ –ø–æ–∑–∏—Ü—ñ—è –Ω–µ–≤–∏–¥–∏–º–∞ –¥–ª—è –∑–æ–º–±—ñ
    if (targetPos[0] === 1 && targetPos[1] === 1) return false;
    const [zRow, zCol] = zombie.pos;
    const [tRow, tCol] = targetPos;
    const lineOfSightDistance = 15;
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ
    if (zRow === tRow && Math.abs(zCol - tCol) < lineOfSightDistance) {
      const start = Math.min(zCol, tCol);
      const end = Math.max(zCol, tCol);
      let wallFound = false;
      for (let i = start + 1; i < end; i++) {
        if (maze[zRow][i] === 1) { wallFound = true; break; }
      }
      if (!wallFound) return true;
    }
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ
    if (zCol === tCol && Math.abs(zRow - tRow) < lineOfSightDistance) {
      const start = Math.min(zRow, tRow);
      const end = Math.max(zRow, tRow);
      let wallFound = false;
      for (let i = start + 1; i < end; i++) {
        if (maze[i][zCol] === 1) { wallFound = true; break; }
      }
      if (!wallFound) return true;
    }
    return false;
  }

  // A* –∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è–º —Å—Ç–∞—Ä—Ç—É –¥–ª—è –∑–æ–º–±—ñ
  findPathAStarWithStartBlock(maze, start, goal) {
    // –Ø–∫—â–æ —Å—Ç–∞—Ä—Ç –∞–∫—Ç–∏–≤–Ω–∏–π, –∑–æ–º–±—ñ –Ω–µ –º–æ–∂—É—Ç—å –π—Ç–∏ –Ω–∞ (1,1)
    const size = this.size;
    const openSet = [start];
    const cameFrom = {};
    const gScore = Array(size).fill().map(() => Array(size).fill(Infinity));
    const fScore = Array(size).fill().map(() => Array(size).fill(Infinity));
    gScore[start[0]][start[1]] = 0;
    fScore[start[0]][start[1]] = this.heuristic(start, goal);

    function posToStr(pos) { return pos[0] + ',' + pos[1]; }
    function strToPos(str) { return str.split(',').map(Number); }

    while (openSet.length > 0) {
      let currentIdx = 0;
      for (let i = 1; i < openSet.length; i++) {
        const [r, c] = openSet[i];
        if (fScore[r][c] < fScore[openSet[currentIdx][0]][openSet[currentIdx][1]]) {
          currentIdx = i;
        }
      }
      const current = openSet.splice(currentIdx, 1)[0];
      if (current[0] === goal[0] && current[1] === goal[1]) {
        let path = [goal];
        let currStr = posToStr(goal);
        while (cameFrom[currStr]) {
          currStr = cameFrom[currStr];
          path.push(strToPos(currStr));
        }
        path.reverse();
        return path;
      }
      const directions = [[-1,0],[1,0],[0,-1],[0,1]];
      for (const [dr, dc] of directions) {
        const nr = current[0] + dr, nc = current[1] + dc;
        if (
          nr >= 0 && nr < size && nc >= 0 && nc < size &&
          maze[nr][nc] === 0 &&
          !(this.isStartActive && nr === 1 && nc === 1)
        ) {
          const tentative_gScore = gScore[current[0]][current[1]] + 1;
          if (tentative_gScore < gScore[nr][nc]) {
            cameFrom[posToStr([nr, nc])] = posToStr(current);
            gScore[nr][nc] = tentative_gScore;
            fScore[nr][nc] = tentative_gScore + this.heuristic([nr, nc], goal);
            if (!openSet.some(([r, c]) => r === nr && c === nc)) {
              openSet.push([nr, nc]);
            }
          }
        }
      }
    }
    return [start];
  }

  heuristic(pos, goal) {
    // –ú–∞–Ω—Ö–µ—Ç—Ç–µ–Ω—Å—å–∫–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å
    return Math.abs(pos[0] - goal[0]) + Math.abs(pos[1] - goal[1]);
  }

  checkZombieInteractions(zombies, maze) {
    const toRemove = new Set();
    const newZombies = [];
    const minZombies = 0;
    const maxZombies = 418;

    for (let i = 0; i < zombies.length; i++) {
      if (toRemove.has(i)) continue;

      for (let j = i + 1; j < zombies.length; j++) {
        if (toRemove.has(j)) continue;

        const z1 = zombies[i];
        const z2 = zombies[j];

        const isTouching = Math.abs(z1.pos[0] - z2.pos[0]) + Math.abs(z1.pos[1] - z2.pos[1]) <= 1;

        // –í–∑–∞—î–º–æ–¥—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —Ç–∏–ø–∏ –†–Ü–ó–ù–Ü
        if (isTouching && z1.type !== z2.type) {
          
          // 50% —à–∞–Ω—Å –Ω–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, 50% –Ω–∞ –∑–∞–≥–∏–±–µ–ª—å
          if (Math.random() < 0.5) {
            // --- –ù–ê–†–û–î–ñ–ï–ù–ù–Ø ---
            if (zombies.length + newZombies.length < maxZombies) {
              const zombieType = Math.random() < 0.1 ? 'boss' : 
                                Math.random() < 0.3 ? 'fast' : 'normal';
              
              // –†—ñ–∑–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–¥–æ—Ä–æ–≤'—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∑–æ–º–±—ñ
              let health;
              switch(zombieType) {
                case 'boss':
                  health = 5;
                  break;
                case 'fast':
                  health = 3;
                  break;
                default:
                  health = 2;
                  break;
              }
              
              newZombies.push({
                pos: this.getRandomEmptyPosition(),
                type: zombieType,
                health: health,
                maxHealth: health,
                speed: zombieType === 'fast' ? 80 : zombieType === 'boss' ? 220 : 140,
                state: 'patrolling',
                direction: [0, 1],
                path: [],
                pathIndex: 0,
                lastMoveTime: Date.now()
              });
            }
          } else {
            // --- –ó–ê–ì–ò–ë–ï–õ–¨ ---
            if (zombies.length - toRemove.size > minZombies) {
              // –í–∏–¥–∞–ª—è—î–º–æ –æ–¥–Ω–æ–≥–æ –∑ –¥–≤–æ—Ö –∑—ñ—Ç–∫–Ω—É–≤—à–∏—Ö—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–æ
              toRemove.add(Math.random() < 0.5 ? i : j);
            }
          }
          
          // –ó–∞–ø–æ–±—ñ–≥–∞—î–º–æ –ø–æ–¥–∞–ª—å—à–∏–º –≤–∑–∞—î–º–æ–¥—ñ—è–º –¥–ª—è —Ü—ñ—î—ó –ø–∞—Ä–∏ –≤ –ø–æ—Ç–æ—á–Ω–æ–º—É —Ç–∏–∫—É
          // —ñ –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≥–æ–ª–æ–≤–Ω–æ–≥–æ –∑–æ–º–±—ñ (i)
          break; 
        }
      }
    }

    // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –≤—Å—ñ –∑–º—ñ–Ω–∏ –ø—ñ—Å–ª—è —ñ—Ç–µ—Ä–∞—Ü—ñ—ó
    const filteredZombies = zombies.filter((_, index) => !toRemove.has(index));
    zombies.length = 0;
    zombies.push(...filteredZombies);
    zombies.push(...newZombies);
    
    // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–æ–º–±—ñ
    this.updateStats();
    // –î–æ–¥–∞—î–º–æ: —è–∫—â–æ –∑–æ–º–±—ñ –Ω–µ –∑–∞–ª–∏—à–∏–ª–æ—Å—å —ñ –≤–∏—Ö—ñ–¥ —â–µ –Ω–µ –∑ º—è–≤–∏–≤—Å—è, –∑ º—è–≤–ª—è—î—Ç—å—Å—è –≤–∏—Ö—ñ–¥
    if (this.zombies.length === 0 && !this.exitVisible) {
      this.spawnExit();
      this.showEventNotification('üèÜ –í—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ! –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∏—Ö—ñ–¥!');
    }
  }

  startZombieTypeChange() {
    if (this.zombieTypeChangeInterval) {
      clearInterval(this.zombieTypeChangeInterval);
    }
    this.zombieTypeChangeInterval = setInterval(() => {
      if (!this.isGameActive || this.isPaused || this.zombies.length === 0) {
        return;
      }
      // –Ø–∫—â–æ –∑–∞–ª–∏—à–∏–≤—Å—è –ª–∏—à–µ 1 –∑–æ–º–±—ñ ‚Äî –Ω–µ –∑–º—ñ–Ω—é—î–º–æ —Ç–∏–ø
      if (this.zombies.length === 1) {
        return;
      }
      // –ó–º—ñ–Ω—é—î–º–æ —Ç–∏–ø –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –∑–æ–º–±—ñ
      const randomZombieIndex = Math.floor(Math.random() * this.zombies.length);
      const zombieToChange = this.zombies[randomZombieIndex];
      const newType = Math.random() < 0.1 ? 'boss' : 
                     Math.random() < 0.3 ? 'fast' : 'normal';
      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –Ω–æ–≤–µ maxHealth –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ç–∏–ø—É
      let newMaxHealth;
      switch(newType) {
        case 'boss':
          newMaxHealth = 5;
          break;
        case 'fast':
          newMaxHealth = 3;
          break;
        default:
          newMaxHealth = 2;
          break;
      }
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤—ñ–¥—Å–æ—Ç–æ–∫ –∑–¥–æ—Ä–æ–≤'—è
      const percent = zombieToChange.health / zombieToChange.maxHealth;
      zombieToChange.type = newType;
      zombieToChange.maxHealth = newMaxHealth;
      zombieToChange.health = Math.max(1, Math.round(percent * newMaxHealth));
      zombieToChange.speed = newType === 'fast' ? 80 : newType === 'boss' ? 220 : 140;
      this.renderMaze();
      this.updateStats();
    }, 10000);
  }

  spawnExit() {
    // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏—Ö—ñ–¥ –≤ –≤–∏–ø–∞–¥–∫–æ–≤–æ–º—É –∫—É—Ç—ñ (–∫—Ä—ñ–º —Å—Ç–∞—Ä—Ç–æ–≤–æ—ó –ø–æ–∑–∏—Ü—ñ—ó)
    const corners = [
      [1, this.size-2],
      [this.size-2, 1],
      [this.size-2, this.size-2]
    ];
    this.exitPos = corners[Math.floor(Math.random()*corners.length)];
    this.exitVisible = true;
    
    // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –≥—Ä–∞–≤—Ü—è
    this.playerStatusEl.textContent = 'üèÜ –ó–Ω–∞–π–¥—ñ—Ç—å —á–µ—Ä–≤–æ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç!';
    this.playerStatusEl.style.background = 'rgba(241, 196, 15, 0.8)'; // –ñ–æ–≤—Ç–∏–π –∫–æ–ª—ñ—Ä
    
    this.renderMaze();
    this.updateStats();
  }

  checkCollision() {
    for (const zombie of this.zombies) {
      if (zombie.pos[0] === this.playerPos[0] && zombie.pos[1] === this.playerPos[1]) {
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≥—Ä–∞–≤–µ—Ü—å –≤ –±–µ–∑–ø–µ—á–Ω—ñ–π –∑–æ–Ω—ñ
        const inSafeZone = this.safeZones.some(sz => 
          sz[0] === this.playerPos[0] && sz[1] === this.playerPos[1]
        );
        
        if (!inSafeZone) {
          if (Date.now() > this.playerBlockedUntil) {
            this.playerBlockedUntil = Date.now() + 3000;
            this.showEventNotification('üèÉ‚Äç‚ôÇÔ∏è –í–∞—Å –∑–Ω–µ—Ä—É—Ö–æ–º–ª–µ–Ω–æ –Ω–∞ 3 —Å–µ–∫—É–Ω–¥–∏!');
          }
          
          const currentTime = Date.now();
          if (currentTime - this.lastDamageTime > this.damageCooldown) {
            this.lastDamageTime = currentTime; // –û–Ω–æ–≤–ª—é—î–º–æ —á–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è
            if (this.audioZombieBite) { this.audioZombieBite.currentTime = 0; this.audioZombieBite.play(); }
            
            const damage = zombie.type === 'boss' ? 30 : zombie.type === 'fast' ? 20 : 15;
            
            if (this.playerShield > 0) {
              const shieldDamage = Math.min(this.playerShield, damage);
              this.playerShield -= shieldDamage;
              const remainingDamage = damage - shieldDamage;
              this.playerHealth -= remainingDamage;
            } else {
              this.playerHealth -= damage;
            }
            
            this.updateStats();
            
            this.showEventNotification(`üí• –û—Ç—Ä–∏–º–∞–Ω–æ ${damage} –ø–æ—à–∫–æ–¥–∂–µ–Ω—å!`);
            
            if (this.playerHealth <= 0) {
              this.endGame(false);
              return;
            }
          }
        }
      }
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≥—Ä–∞–≤–µ—Ü—å –¥–æ—Å—è–≥ –≤–∏—Ö–æ–¥—É
    if (this.exitVisible && this.exitPos && 
        this.playerPos[0] === this.exitPos[0] && this.playerPos[1] === this.exitPos[1]) {
      this.endGame(true);
    }
  }

  startItemSpawning() {
    // –°–ø–∞–≤–Ω –ø–∞—Ç—Ä–æ–Ω—ñ–≤
    setTimeout(() => this.spawnAmmo(), 3000 + Math.random() * 4000);
    
    // –°–ø–∞–≤–Ω –∑–¥–æ—Ä–æ–≤'—è
    setTimeout(() => this.spawnHealth(), 5000 + Math.random() * 5000);
    
    // –°–ø–∞–≤–Ω —â–∏—Ç–∞
    setTimeout(() => this.spawnShield(), 8000 + Math.random() * 6000);
    
    // –°–ø–∞–≤–Ω —Ç–æ–ø–æ—Ä–∞
    setTimeout(() => this.spawnPickaxe(), 10000 + Math.random() * 8000);
    
    // –°–ø–∞–≤–Ω –Ω–æ–∂–∞
    setTimeout(() => this.spawnKnife(), 12000 + Math.random() * 10000);
    
    // –°–ø–∞–≤–Ω –º—ñ–Ω–∏
    setTimeout(() => this.spawnMine(), 14000 + Math.random() * 10000);
  }

  spawnAmmo() {
    if (this.ammoVisible) return;
    
    const pos = this.getRandomEmptyPosition();
    this.ammoPos = pos;
    this.ammoVisible = true;
    this.renderMaze();
    
    this.ammoTimeout = setTimeout(() => {
      this.hideAmmo();
    }, 5000);
  }

  hideAmmo() {
    this.ammoVisible = false;
    this.ammoPos = null;
    this.renderMaze();
  }

  spawnHealth() {
    if (this.healthVisible) return;
    
    const pos = this.getRandomEmptyPosition();
    this.healthPos = pos;
    this.healthVisible = true;
    this.renderMaze();
    
    this.healthTimeout = setTimeout(() => {
      this.hideHealth();
    }, 5000);
  }

  hideHealth() {
    this.healthVisible = false;
    this.healthPos = null;
    this.renderMaze();
  }

  spawnShield() {
    if (this.shieldVisible) return;
    
    const pos = this.getRandomEmptyPosition();
    this.shieldPos = pos;
    this.shieldVisible = true;
    this.renderMaze();
    
    this.shieldTimeout = setTimeout(() => {
      this.hideShield();
    }, 5000);
  }

  hideShield() {
    this.shieldVisible = false;
    this.shieldPos = null;
    this.renderMaze();
  }

  spawnPickaxe() {
    if (!this.isGameActive) return;
    
    const pos = this.getRandomEmptyPosition();
    this.pickaxePos = pos;
    this.pickaxeVisible = true;
    this.renderMaze();
    
    // –ó–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ 8-12 —Å–µ–∫—É–Ω–¥
    const duration = 8000 + Math.random() * 4000;
    this.pickaxeTimeout = setTimeout(() => {
      this.hidePickaxe();
      // –ü–ª–∞–Ω—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–ø–∞–≤–Ω
      setTimeout(() => this.spawnPickaxe(), 15000 + Math.random() * 10000);
    }, duration);
  }

  hidePickaxe() {
    this.pickaxeVisible = false;
    this.pickaxePos = null;
    this.renderMaze();
    if (this.pickaxeTimeout) clearTimeout(this.pickaxeTimeout);
  }

  spawnKnife() {
    if (!this.isGameActive) return;
    
    const pos = this.getRandomEmptyPosition();
    this.knifePos = pos;
    this.knifeVisible = true;
    this.renderMaze();
    
    // –ó–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ 8-12 —Å–µ–∫—É–Ω–¥
    const duration = 8000 + Math.random() * 4000;
    this.knifeTimeout = setTimeout(() => {
      this.hideKnife();
      // –ü–ª–∞–Ω—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–ø–∞–≤–Ω
      setTimeout(() => this.spawnKnife(), 20000 + Math.random() * 15000);
    }, duration);
  }

  hideKnife() {
    this.knifeVisible = false;
    this.knifePos = null;
    this.renderMaze();
    if (this.knifeTimeout) clearTimeout(this.knifeTimeout);
  }

  spawnMine() {
    if (this.mineVisible) return;
    const pos = this.getRandomEmptyPosition();
    this.minePos = pos;
    this.mineVisible = true;
    this.renderMaze();
    this.mineTimeout = setTimeout(() => {
      this.hideMine();
    }, 6000);
  }

  hideMine() {
    this.mineVisible = false;
    this.minePos = null;
    this.renderMaze();
    if (this.mineTimeout) clearTimeout(this.mineTimeout);
  }

  tryBreakWall() {
    // –ú–æ–∂–Ω–∞ —Ä–æ–∑–±–∏—Ç–∏ –æ–¥–Ω—É —Å—Ç—ñ–Ω—É –Ω–∞–≤–∫–æ–ª–æ –≥—Ä–∞–≤—Ü—è (–≤–≥–æ—Ä—É, –≤–Ω–∏–∑, –≤–ª—ñ–≤–æ, –≤–ø—Ä–∞–≤–æ)
    const dirs = [[-1,0],[1,0],[0,-1],[0,1]];
    for (const [dr,dc] of dirs) {
      const r = this.playerPos[0] + dr;
      const c = this.playerPos[1] + dc;
      if (r >= 0 && r < this.size && c >= 0 && c < this.size && this.maze[r][c] === 1) {
        this.maze[r][c] = 0;
        this.playerHasPickaxe = false;
        if (this.audioBreakWall) { this.audioBreakWall.currentTime = 0; this.audioBreakWall.play(); }
        this.showEventNotification('üß± –°—Ç—ñ–Ω—É –ø—Ä–æ—Ä—É–±–ª–µ–Ω–æ!');
        
        // –û—á–∏—â–∞—î–º–æ —à–ª—è—Ö–∏ –≤—Å—ñ—Ö –∑–æ–º–±—ñ, —â–æ–± –≤–æ–Ω–∏ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–ª–∏ –º–∞—Ä—à—Ä—É—Ç
        for (const zombie of this.zombies) {
          zombie.path = [];
          zombie.pathIndex = 0;
        }

        this.renderMaze();
        // –ü—ñ—Å–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–ø–æ—Ä–∞ ‚Äî –∑'—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∏–π —á–µ—Ä–µ–∑ —á–∞—Å
        this.spawnPickaxeWithDelay();
        break;
      }
    }
  }

  spawnPickaxeWithDelay() {
    // –ó'—è–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 3-7 —Å–µ–∫—É–Ω–¥
    const delay = 3000 + Math.random() * 4000;
    setTimeout(() => {
      if (this.isGameActive && !this.playerHasPickaxe) {
        this.spawnPickaxe();
      }
    }, delay);
  }

  startSafeZoneSpawning() {
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ü–∏–∫–ª –ø–æ—è–≤–∏/–∑–Ω–∏–∫–Ω–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–æ—ó –∑–æ–Ω–∏
    const initialDelay = 3000 + Math.random() * 7000; // 3-10 —Å–µ–∫—É–Ω–¥
    this.safeZoneTimeout = setTimeout(() => {
      if (!this.isGameActive || this.isPaused) return;
      this.safeZoneCycle();
    }, initialDelay);
  }

  safeZoneCycle() {
    // –ü–æ—è–≤–∞ –∑–æ–Ω–∏
    this.safeZones = [];
    const pos = this.getRandomEmptyPosition();
    this.safeZones.push(pos);
    this.renderMaze();
    this.showEventNotification('üõ°Ô∏è –ó º—è–≤–∏–ª–∞—Å—è –±–µ–∑–ø–µ—á–Ω–∞ –∑–æ–Ω–∞!');
    // –ó–æ–Ω–∞ —ñ—Å–Ω—É—î 6-14 —Å–µ–∫—É–Ω–¥, –ø–æ—Ç—ñ–º –∑–Ω–∏–∫–∞—î
    const zoneDuration = 6000 + Math.random() * 8000; // 6-14 —Å–µ–∫—É–Ω–¥
    this.safeZoneTimeout = setTimeout(() => {
      // –ó–Ω–∏–∫–∞—î –∑–æ–Ω–∞
      this.safeZones = this.safeZones.filter(sz => 
        !(sz[0] === pos[0] && sz[1] === pos[1])
      );
      this.renderMaze();
      // –Ø–∫—â–æ –≥—Ä–∞–≤–µ—Ü—å –±—É–≤ —É —Ü—ñ–π –∑–æ–Ω—ñ ‚Äî –æ–¥—Ä–∞–∑—É –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å —ñ –∑—É–ø–∏–Ω–∏—Ç–∏ –±–æ–Ω—É—Å–∏
      if (this.playerPos[0] === pos[0] && this.playerPos[1] === pos[1]) {
        this.playerStatusEl.textContent = 'üßü‚Äç‚ôÇÔ∏è –í–∏–∂–∏–≤–∞—î...';
        this.playerStatusEl.style.background = 'rgba(52, 152, 219, 0.8)';
        if (this.safeZoneAmmoInterval) {
          clearInterval(this.safeZoneAmmoInterval);
          this.safeZoneAmmoInterval = null;
        }
        if (this.safeZoneShieldInterval) {
          clearInterval(this.safeZoneShieldInterval);
          this.safeZoneShieldInterval = null;
        }
      }
      // –ü–∞—É–∑–∞ 10 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—É–ø–Ω–æ—é –ø–æ—è–≤–æ—é –∑–æ–Ω–∏
      this.safeZoneTimeout = setTimeout(() => {
        if (!this.isGameActive || this.isPaused) return;
        this.safeZoneCycle();
      }, 10000); // 10 —Å–µ–∫—É–Ω–¥
    }, zoneDuration);
  }

  startTimer() {
    if (this.timerInterval) clearInterval(this.timerInterval);
    this.timerInterval = setInterval(() => {
      if (!this.isPaused && this.isGameActive) {
        this.survivalTime = Math.floor((Date.now() - this.startTime) / 1000);
        const minutes = Math.floor(this.survivalTime / 60);
        const seconds = this.survivalTime % 60;
        this.timerEl.textContent = `–ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        // –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è —Ç–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∑–æ–º–±—ñ
        // –¢–µ–ø–µ—Ä –∑–æ–º–±—ñ –∑'—è–≤–ª—è—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –∫–æ–Ω—Ç–∞–∫—Ç—É —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤
      }
    }, 1000);
  }

  updateStats() {
    document.getElementById('healthDisplay').textContent = this.playerHealth;
    document.getElementById('shieldDisplay').textContent = this.playerShield;
    document.getElementById('ammoDisplay').textContent = this.playerAmmo;
    document.getElementById('zombieCount').textContent = this.zombies.length;
    document.getElementById('levelDisplay').textContent = this.playerLevel;
    
    // –î–æ–¥–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–æ–ø–æ—Ä–∞
    const pickaxeIndicator = document.getElementById('pickaxeIndicator');
    if (!pickaxeIndicator) {
      const statsBar = document.getElementById('statsBar');
      const pickaxeDiv = document.createElement('div');
      pickaxeDiv.className = 'stat-item';
      pickaxeDiv.id = 'pickaxeIndicator';
      statsBar.appendChild(pickaxeDiv);
    }
    document.getElementById('pickaxeIndicator').innerHTML = `ü™ì –¢–æ–ø–æ—Ä: <span style="color:${this.playerHasPickaxe ? 'gold' : '#666'}">${this.playerHasPickaxe ? '–Ñ' : '–ù–µ–º–∞—î'}</span>`;
    
    // –î–æ–¥–∞—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–æ–∂–∞
    const knifeIndicator = document.getElementById('knifeIndicator');
    if (!knifeIndicator) {
      const statsBar = document.getElementById('statsBar');
      const knifeDiv = document.createElement('div');
      knifeDiv.className = 'stat-item';
      knifeDiv.id = 'knifeIndicator';
      statsBar.appendChild(knifeDiv);
    }
    document.getElementById('knifeIndicator').innerHTML = `üî™ –ù—ñ–∂: <span style="color:${this.playerHasKnife ? '#33cc33' : '#666'}">${this.playerHasKnife ? '–Ñ' : '–ù–µ–º–∞—î'}</span>`;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –º–∏–Ω
    const mineIndicator = document.getElementById('mineIndicator');
    if (!mineIndicator) {
      const statsBar = document.getElementById('statsBar');
      const mineDiv = document.createElement('div');
      mineDiv.className = 'stat-item';
      mineDiv.id = 'mineIndicator';
      statsBar.appendChild(mineDiv);
    }
    document.getElementById('mineIndicator').innerHTML = `üí£ –ú—ñ–Ω–∏: <span style="color:${this.playerMines > 0 ? '#ff2222' : '#666'}">${this.playerMines}</span>`;
  }

  updateStatus(status) {
    const statusMap = {
      'ready': { text: '–ì–æ—Ç–æ–≤ –¥–æ –≤–∏–∂–∏–≤–∞–Ω–Ω—è', class: 'status-ready' },
      'playing': { text: '–í–∏–∂–∏–≤–∞—î...', class: 'status-playing' },
      'finished': { text: '–ó–∞–≥–∏–Ω—É–≤!', class: 'status-finished ' }
    };

    const statusInfo = statusMap[status];
    if (statusInfo) {
      this.playerStatusEl.textContent = statusInfo.text;
      this.playerStatusEl.className = `player-status ${statusInfo.class}`;
    }
  }

  togglePause() {
    this.isPaused = !this.isPaused;
    this.pauseBtn.textContent = this.isPaused ? '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏' : '‚è∏Ô∏è –ü–∞—É–∑–∞';

    if (this.isPaused) {
      this.updateStatus('ready');
    } else {
      this.updateStatus('playing');
      this.startTime += Date.now() - this.pauseTime;
    }

    if (this.isPaused) {
      this.pauseTime = Date.now();
    }
  }

  endGame(survived) {
    this.isGameActive = false;
    this.clearAllIntervals();
    
    if (survived) {
      this.winnerText.textContent = 'üèÜ –ü–ï–†–ï–ú–û–ì–ê!';
      this.winnerMessage.textContent = `–í—ñ—Ç–∞—î–º–æ! –í–∏ –∑–Ω–∏—â–∏–ª–∏ –≤—Å—ñ—Ö –∑–æ–º–±—ñ —Ç–∞ –∑–Ω–∞–π—à–ª–∏ –≤–∏—Ö—ñ–¥!\n–ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è: ${Math.floor(this.survivalTime / 60)}:${(this.survivalTime % 60).toString().padStart(2, '0')}\n–ó–Ω–∏—â–µ–Ω–æ –∑–æ–º–±—ñ: ${this.zombiesKilled}\n–î–æ—Å—è–≥–Ω—É—Ç–∏–π —Ä—ñ–≤–µ–Ω—å: ${this.playerLevel}`;
      if (this.audioWin) { this.audioWin.currentTime = 0; this.audioWin.play(); }
    } else {
      this.winnerText.textContent = 'üíÄ –ó–ê–ì–ò–ù–£–í!';
      this.winnerMessage.textContent = `–í–∏ –Ω–µ –≤–∏–∂–∏–ª–∏ –≤ –∑–æ–º–±—ñ-–∞–ø–æ–∫–∞–ª—ñ–ø—Å–∏—Å—ñ!\n–ß–∞—Å –≤–∏–∂–∏–≤–∞–Ω–Ω—è: ${Math.floor(this.survivalTime / 60)}:${(this.survivalTime % 60).toString().padStart(2, '0')}\n–ó–Ω–∏—â–µ–Ω–æ –∑–æ–º–±—ñ: ${this.zombiesKilled}\n–î–æ—Å—è–≥–Ω—É—Ç–∏–π —Ä—ñ–≤–µ–Ω—å: ${this.playerLevel}`;
      if (this.audioPlayerDeath) { this.audioPlayerDeath.currentTime = 0; this.audioPlayerDeath.play(); }
      if (this.audioLose) { this.audioLose.currentTime = 0; this.audioLose.play(); }
    }
    
    this.winnerOverlay.style.display = 'flex';
    this.pauseBtn.disabled = true;
  }

  showEventNotification(message) {
    const existingNotification = document.querySelector('.event-notification');
    if (existingNotification) {
      existingNotification.remove();
    }

    const notification = document.createElement('div');
    notification.className = 'event-notification';
    notification.textContent = message;
    document.body.appendChild(notification);

    setTimeout(() => {
      if (notification.parentNode) {
        notification.style.animation = 'fadeOut 0.5s ease-out';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.remove();
          }
        }, 500);
      }
    }, 3000);
  }

  startRandomMazeEvents() {
    this.scheduleNextRandomEvent();
  }

  scheduleNextRandomEvent() {
    if (!this.isGameActive || this.isPaused) return;
    
    // –í–∏–ø–∞–¥–∫–æ–≤–∏–π —á–∞—Å –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –ø–æ–¥—ñ—ó: 1-120 —Å–µ–∫—É–Ω–¥
    const delay = 1000 + Math.random() * 119000;
    
    this.eventInterval = setTimeout(() => {
        if (!this.isGameActive || this.isPaused) return;
        this.randomMazeEvent();
        // –ü–ª–∞–Ω—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω—É –ø–æ–¥—ñ—é
        this.scheduleNextRandomEvent();
    }, delay);
  }

  randomMazeEvent() {
    const isAdd = Math.random() < 0.5;
    const size = this.size;
    const forbiddenSet = new Set();

    // –ó–∞–±–æ—Ä–æ–Ω—è—î–º–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫–ª—ñ—Ç–∏–Ω–∫—É –≥—Ä–∞–≤—Ü—è, –∑–æ–º–±—ñ, –ø—Ä–µ–¥–º–µ—Ç—ñ–≤, —Å—Ç–∞—Ä—Ç–∞/–≤–∏—Ö–æ–¥—É —Ç–∞ –±–µ–∑–ø–µ—á–Ω–∏—Ö –∑–æ–Ω
    forbiddenSet.add(this.playerPos[0] + ',' + this.playerPos[1]);
    this.zombies.forEach(z => forbiddenSet.add(z.pos[0] + ',' + z.pos[1]));
    if (this.exitVisible && this.exitPos) {
        forbiddenSet.add(this.exitPos[0] + ',' + this.exitPos[1]);
    }
    if (this.ammoVisible && this.ammoPos) forbiddenSet.add(this.ammoPos[0] + ',' + this.ammoPos[1]);
    if (this.healthVisible && this.healthPos) forbiddenSet.add(this.healthPos[0] + ',' + this.healthPos[1]);
    if (this.shieldVisible && this.shieldPos) forbiddenSet.add(this.shieldPos[0] + ',' + this.shieldPos[1]);
    if (this.pickaxeVisible && this.pickaxePos) forbiddenSet.add(this.pickaxePos[0] + ',' + this.pickaxePos[1]);
    if (this.knifeVisible && this.knifePos) forbiddenSet.add(this.knifePos[0] + ',' + this.knifePos[1]);
    this.safeZones.forEach(sz => forbiddenSet.add(sz[0] + ',' + sz[1]));
    forbiddenSet.add('1,1'); // Start position

    let wallChanged = false;
    // –ü–∏—Ç–∞—î–º–æ—Å—è 100 —Ä–∞–∑ –∑–Ω–∞–π—Ç–∏ –ø—ñ–¥—Ö–æ–¥—è—â—É –∫–ª—ñ—Ç–∏–Ω–∫—É
    for (let attempt = 0; attempt < 100; attempt++) {
        const row = Math.floor(Math.random() * (size - 2)) + 1;
        const col = Math.floor(Math.random() * (size - 2)) + 1;
        const key = row + ',' + col;

        if (forbiddenSet.has(key)) continue;

        if (isAdd && this.maze[row][col] === 0) {
            this.maze[row][col] = 1;
            this.showEventNotification('üß± –ó\'—è–≤–∏–ª–∞—Å—è –Ω–æ–≤–∞ —Å—Ç—ñ–Ω–∞!');
            wallChanged = true;
            break;
        } else if (!isAdd && this.maze[row][col] === 1) {
            this.maze[row][col] = 0;
            this.showEventNotification('üï≥Ô∏è –°—Ç—ñ–Ω–∞ –∑–Ω–∏–∫–ª–∞!');
            wallChanged = true;
            break;
        }
    }

    if (wallChanged) {
        // –û—á–∏—â–∞—î–º–æ —à–ª—è—Ö–∏ –≤—Å—ñ—Ö –∑–æ–º–±—ñ, —â–æ–± –≤–æ–Ω–∏ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–ª–∏ –º–∞—Ä—à—Ä—É—Ç
        for (const zombie of this.zombies) {
            zombie.path = [];
            zombie.pathIndex = 0;
        }
        this.renderMaze();
    }
  }

  checkMinesExplosion() {
    for (let i = this.activeMines.length - 1; i >= 0; i--) {
      const {pos: [mineRow, mineCol]} = this.activeMines[i];
      const zombieIndex = this.zombies.findIndex(z => z.pos[0] === mineRow && z.pos[1] === mineCol);
      if (zombieIndex !== -1) {
        const zombie = this.zombies[zombieIndex];
        const mineDamage = Math.floor(Math.random() * 5) + 1; // 1-5
        zombie.health -= mineDamage;
        zombie.stunnedUntil = Date.now() + 1000;
        if (zombie.health <= 0) {
          this.zombies.splice(zombieIndex, 1);
          this.zombiesKilled++;
          this.showEventNotification(`üí• –ú—ñ–Ω–∞ –∑–Ω–∏—â–∏–ª–∞ –∑–æ–º–±—ñ! (${mineDamage} —É—Ä–æ–Ω—É)`);
        } else {
          this.showEventNotification(`üí• –ú—ñ–Ω–∞ –ø–æ—Ä–∞–Ω–∏–ª–∞ –∑–æ–º–±—ñ! -${mineDamage} HP (${zombie.health}/${zombie.maxHealth})`);
        }
        if (this.audioMineExplosion) { this.audioMineExplosion.currentTime = 0; this.audioMineExplosion.play(); }
        this.activeMines.splice(i, 1);
        this.renderMaze();
        this.updateStats();
        // –î–æ–¥–∞—î–º–æ: —è–∫—â–æ –∑–æ–º–±—ñ –Ω–µ –∑–∞–ª–∏—à–∏–ª–æ—Å—å —ñ –≤–∏—Ö—ñ–¥ —â–µ –Ω–µ –∑ º—è–≤–∏–≤—Å—è, –∑ º—è–≤–ª—è—î—Ç—å—Å—è –≤–∏—Ö—ñ–¥
        if (this.zombies.length === 0 && !this.exitVisible) {
          this.spawnExit();
          this.showEventNotification('üèÜ –í—Å—ñ –∑–æ–º–±—ñ –∑–Ω–∏—â–µ–Ω—ñ! –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∏—Ö—ñ–¥!');
        }
      }
    }
  }

  tryPlaceMine() {
    if (this.playerMines > 0) {
      const [row, col] = this.playerPos;
      // –ó–∞–ø—Ä–µ—â–∞–µ–º —Å—Ç–∞–≤–∏—Ç—å –º–∏–Ω—É –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∑–æ–Ω–µ –∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
      const isInSafeZone = this.safeZones.some(sz => sz[0] === row && sz[1] === col);
      const isStart = row === 1 && col === 1;
      const isZombieOnPlayer = this.zombies.some(z => z.pos[0] === row && z.pos[1] === col);
      if (
        this.maze[row][col] === 0 &&
        !this.activeMines.some(m => m.pos[0] === row && m.pos[1] === col) &&
        !(this.ammoVisible && this.ammoPos && row === this.ammoPos[0] && col === this.ammoPos[1]) &&
        !(this.healthVisible && this.healthPos && row === this.healthPos[0] && col === this.healthPos[1]) &&
        !(this.shieldVisible && this.shieldPos && row === this.shieldPos[0] && col === this.shieldPos[1]) &&
        !(this.pickaxeVisible && this.pickaxePos && row === this.pickaxePos[0] && col === this.pickaxePos[1]) &&
        !(this.knifeVisible && this.knifePos && row === this.knifePos[0] && col === this.knifePos[1]) &&
        !(this.mineVisible && this.minePos && row === this.minePos[0] && col === this.minePos[1]) &&
        !isInSafeZone &&
        !isStart &&
        !isZombieOnPlayer
      ) {
        this.activeMines.push({pos: [row, col], placedAt: Date.now()});
        this.playerMines--;
        this.updateStats();
        if (this.audioMinePlace) { this.audioMinePlace.currentTime = 0; this.audioMinePlace.play(); }
        this.renderMaze();
      } else if (isZombieOnPlayer) {
        this.showEventNotification('‚ùå –ù–µ –º–æ–∂–Ω–∞ —Å—Ç–∞–≤–∏—Ç–∏ –º—ñ–Ω—É, –∫–æ–ª–∏ –Ω–∞ –∫–ª—ñ—Ç–∏–Ω—Ü—ñ —î –∑–æ–º–±—ñ!');
      } else {
        this.showEventNotification('‚ùå –ù–µ–º–æ–∂–ª–∏–≤–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –º—ñ–Ω—É —Ç—É—Ç!');
      }
    } else {
      this.showEventNotification('‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –º—ñ–Ω!');
    }
  }

  checkPlayerMineExplosion() {
    for (let i = this.activeMines.length - 1; i >= 0; i--) {
      const {pos: [mineRow, mineCol], placedAt} = this.activeMines[i];
      if (this.playerPos[0] === mineRow && this.playerPos[1] === mineCol) {
        // –ù–µ –ø–æ–¥—Ä—ã–≤–∞–µ–º—Å—è, –µ—Å–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 1 —Å–µ–∫—É–Ω–¥—ã
        if (Date.now() - placedAt < 500) continue;
        this.activeMines.splice(i, 1);
        // –ë—ã–ª–æ: const damage = 40;
        const damage = Math.floor(Math.random() * 200) + 1; // 1-200 —É—Ä–æ–Ω–∞
        if (this.playerShield > 0) {
          const shieldDamage = Math.min(this.playerShield, damage);
          this.playerShield -= shieldDamage;
          const remainingDamage = damage - shieldDamage;
          this.playerHealth -= remainingDamage;
        } else {
          this.playerHealth -= damage;
        }
        this.playerBlockedUntil = Date.now() + 3000;
        this.updateStats();
        this.showEventNotification(`üí• –í–∏ –ø—ñ–¥—ñ—Ä–≤–∞–ª–∏—Å—è –Ω–∞ –º—ñ–Ω—ñ! -${damage} HP`);
        if (this.audioMineExplosion) { this.audioMineExplosion.currentTime = 0; this.audioMineExplosion.play(); }
        this.renderMaze();
        if (this.playerHealth <= 0) {
          this.endGame(false);
        }
      }
    }
  }
}

// –ó–∞–ø—É—Å–∫ –≥—Ä–∏
window.addEventListener('DOMContentLoaded', () => {
  window.zombieGame = new ZombieApocalypseGame();
});
</script>

<nav style="margin-bottom: 18px;">
  <a href="index.html" style="color:#fff; font-weight:bold; margin-right:18px; text-decoration:none;">–ì–æ–ª–æ–≤–Ω–∞</a>
  <a href="global.html" style="color:#fff; font-weight:bold; margin-right:18px; text-decoration:none;">GLOBAL</a>
  <a href="test-mode.html" style="color:#fff; font-weight:bold; text-decoration:none;">test-mod</a>
  <a href="npc-ai.html" style="color:#fff; font-weight:bold; text-decoration:none;">npc-ai</a>
  <a href="standings.html" style="color:#fff; font-weight:bold; text-decoration:none;">–¢—É—Ä–Ω—ñ—Ä–Ω–∞ —Ç–∞–±–ª–∏—Ü—è</a>
</nav>

<div class="instructions">
  <h3>üßü‚Äç‚ôÇÔ∏è –ó–æ–º–±—ñ-–ê–ø–æ–∫–∞–ª—ñ–ø—Å–∏—Å: –õ–∞–±—ñ—Ä–∏–Ω—Ç –í–∏–∂–∏–≤–∞–Ω–Ω—è</h3>
  <p><strong>üéØ –¶—ñ–ª—å:</strong> –ó–Ω–∏—â–∏—Ç–∏ –≤—Å—ñ—Ö –∑–æ–º–±—ñ, —â–æ–± –∑'—è–≤–∏–≤—Å—è —á–µ—Ä–≤–æ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç (–≤–∏—Ö—ñ–¥), –ø–æ—Ç—ñ–º –¥—ñ—Å—Ç–∞—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ!</p>
  <p><strong>üéÆ –ö–µ—Ä—É–≤–∞–Ω–Ω—è:</strong> –°—Ç—Ä—ñ–ª–∫–∏ ‚Üê‚Üë‚Üì‚Üí –∞–±–æ WASD –¥–ª—è —Ä—É—Ö—É, –ü—Ä–æ–±—ñ–ª –¥–ª—è –∞—Ç–∞–∫–∏ (—Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ —Å—Ç–æ—ó—Ç–µ), E –¥–ª—è —Ç–æ–ø–æ—Ä–∞</p>
  <p><strong>üìã –ü—Ä–∞–≤–∏–ª–∞:</strong> –ó–µ–ª–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç - —Å—Ç–∞—Ä—Ç. –ó–æ–º–±—ñ —Ä—É—Ö–∞—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é A* –∞–ª–≥–æ—Ä–∏—Ç–º—É. –ó–±–∏—Ä–∞–π—Ç–µ –ø–∞—Ç—Ä–æ–Ω–∏, –∑–¥–æ—Ä–æ–≤'—è, —â–∏—Ç–∏, —Ç–æ–ø–æ—Ä–∏ —Ç–∞ –Ω–æ–∂—ñ. –ë–µ–∑–ø–µ—á–Ω—ñ –∑–æ–Ω–∏ —Ç–∏–º—á–∞—Å–æ–≤–æ –∑–∞—Ö–∏—â–∞—é—Ç—å –≤—ñ–¥ –∑–æ–º–±—ñ!</p>
  <p><strong>üßü‚Äç‚ôÇÔ∏è –ó–æ–º–±—ñ:</strong> –ó'—è–≤–ª—è—é—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ñ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤. –¢–∏–ø–∏ –∑–º—ñ–Ω—é—é—Ç—å—Å—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥.</p>
  <p><strong>üí™ –ó–¥–æ—Ä–æ–≤'—è –∑–æ–º–±—ñ:</strong> –ó–≤–∏—á–∞–π–Ω–∏–π (2 HP), –®–≤–∏–¥–∫–∏–π (3 HP), –ë–æ—Å (5 HP)</p>
  <p><strong>ü™ì –¢–æ–ø–æ—Ä:</strong> –î–æ–∑–≤–æ–ª—è—î –ø—Ä–æ—Ä—É–±—É–≤–∞—Ç–∏ —Å—Ç—ñ–Ω–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö —à–ª—è—Ö—ñ–≤!</p>
  <p><strong>üî™ –ù—ñ–∂:</strong> –ü–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è –±–ª–∏–∂–Ω—å–æ–≥–æ –±–æ—é! –ë–µ–∑ –Ω–æ–∂–∞ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –∑–æ–º–±—ñ –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ.</p>
  <p><strong>üî´ –ë–æ–π–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞:</strong> –ë–ª–∏–∂–Ω—ñ–π –±—ñ–π –Ω–æ–∂–µ–º (–Ω–µ –≤–∏—Ç—Ä–∞—á–∞—î –ø–∞—Ç—Ä–æ–Ω–∏) –∞–±–æ —Å—Ç—Ä—ñ–ª—å–±–∞ (–≤–∏—Ç—Ä–∞—á–∞—î –ø–∞—Ç—Ä–æ–Ω–∏). –ë–µ–∑ –Ω–æ–∂–∞ - –Ω–µ–º–æ–∂–ª–∏–≤–æ –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –≤ –±–ª–∏–∂–Ω—å–æ–º—É –±–æ—é!</p>
  <p><strong>üèÜ –ü–µ—Ä–µ–º–æ–≥–∞:</strong> –°–ø–æ—á–∞—Ç–∫—É –∑–Ω–∏—â—ñ—Ç—å –í–°–Ü–• –∑–æ–º–±—ñ ‚Üí –∑'—è–≤–∏—Ç—å—Å—è —á–µ—Ä–≤–æ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç —É –≤–∏–ø–∞–¥–∫–æ–≤–æ–º—É –∫—É—Ç—ñ ‚Üí –¥—ñ—Å—Ç–∞–Ω—å—Ç–µ—Å—è –¥–æ –Ω—å–æ–≥–æ!</p>
  <p><strong>üéÆ –†—ñ–≤–Ω—ñ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:</strong> –õ–µ–≥–∫–∏–π, –°–µ—Ä–µ–¥–Ω—ñ–π, –í–∞–∂–∫–∏–π, –ö–æ—à–º–∞—Ä</p>
</div>
</body>
</html>
